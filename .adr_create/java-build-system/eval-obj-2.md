# OBJ-2: ビルドパフォーマンス — 評価結果

## 提案した代替案

ビルドパフォーマンスの観点から、以下の代替案を提案する。

- **Gradle with Build Cache**: インクリメンタルビルドとビルドキャッシュ機能により、開発中の頻繁なビルドでの時間短縮を最大化できる。research.md によれば、Gradle は Maven の2倍以上高速であり、Build Cache 使用時は最大100倍の差が生じる。CI/CD環境でのキャッシュ活用により、継続的にパフォーマンス優位性を維持できる。

- **Gradle with Configuration Cache**: Gradle 9.x 系の Configuration Cache 機能を活用することで、設定時間を大幅に削減し、特に大規模コードベースでビルド開始の遅延を最小化できる。Kotlin DSL の最適化により、ビルドロジック編集時のフィードバックループが最大2.5倍高速化される。

- **Maven with Maven Daemon**: Maven の最新機能である Maven Daemon を活用することで、JVM起動コストを削減し、繰り返しビルドのパフォーマンスを改善できる。Maven 4 への移行を見据えた場合、エコシステムの成熟度とパフォーマンス向上の両立が期待できる。

- **Maven 3.9.x (Standard)**: 安定版 Maven 3.9.12 を標準構成で使用する。パフォーマンスは Gradle に劣るが、エコシステムの成熟度とツールチェーンの安定性を優先し、ビルド時間を許容範囲内で管理する。

## 評価

### Gradle with Build Cache

- 評価: ◎
- 利点:
  - research.md の実測データによれば、Build Cache 使用時に最大100倍の速度向上が可能
  - インクリメンタルビルド、並列タスク実行、ローカルキャッシングにより、開発中の頻繁なビルドで大幅な時間短縮を実現
  - Gradle 9.x 系は継続的にパフォーマンス最適化を実施しており（Tooling API 改善で最大12%向上）、速度面での優位性は拡大傾向にある
  - Maven ユーザーが Build Cache 導入により最大90%短縮、Gradle ユーザーはさらに約50%追加短縮を実現している実績がある
- 欠点:
  - Build Cache の効果は CI/CD 環境の構成に依存する（S7: CI/CD環境でビルドキャッシュを利用可能である）
  - 初回ビルドではキャッシュが存在せず、効果が限定的
  - プロジェクト固有の条件で実測しない限り、期待されたパフォーマンス向上が得られない可能性がある（S8: パフォーマンス面では Gradle が Maven より優位である）
- 根拠:
  - research.md の複数の出典（Gradle公式、Buildkite比較）で一貫してパフォーマンス優位性が示されている
  - Gradle 9.3.1 および開発中の 9.5.0 で継続的な最適化が行われており、パフォーマンス重視の開発方針が確認できる
  - Build Cache はローカルとリモート両方に対応しており、チーム全体でのビルド効率化が可能
- CSD依存:
  - S7（CI/CD環境でビルドキャッシュを利用可能である）に依存。CI/CD環境がキャッシュをサポートしない場合、リモートキャッシュの効果が得られない
  - S8（パフォーマンス面では Gradle が Maven より優位である）に依存。プロジェクト固有の条件で結果が変わる可能性がある
  - D5（CI/CD環境の具体的な構成とキャッシュ機能の有無）の判明により評価が変化する

### Gradle with Configuration Cache

- 評価: ○
- 利点:
  - Configuration Cache により設定時間を大幅に削減し、ビルド開始の遅延を最小化できる
  - Kotlin DSL の最適化により、ビルドロジック編集時のフィードバックループが最大2.5倍高速化される（research.md）
  - 大規模コードベースで効果が高く、プロジェクト規模の成長に対してスケーラビリティが高い
  - Gradle 9.x 系の最新機能を活用することで、継続的なパフォーマンス向上が期待できる
- 欠点:
  - Configuration Cache は比較的新しい機能であり、一部のプラグインで互換性問題が発生する可能性がある
  - Kotlin DSL の学習コストがチームにとって負担となる可能性がある（S10: チームは Groovy/Kotlin DSL または XML の記述に抵抗がない）
  - プロジェクト規模が中規模以上にならない場合、Configuration Cache の効果が限定的（S2: プロジェクト規模は中規模以上になる見込みである）
- 根拠:
  - Gradle 公式ドキュメントで Configuration Cache の効果が明示されており、特に大規模コードベースでの効果が強調されている
  - Kotlin 2 の機能活用による Kotlin DSL 最適化が Gradle 9.0.0 で導入され、ビルドロジック編集時のパフォーマンスが実測で向上している
- CSD依存:
  - S2（プロジェクト規模は中規模以上になる見込みである）に依存。規模が小さい場合、Configuration Cache の効果が限定的
  - S10（チームは Groovy/Kotlin DSL または XML の記述に抵抗がない）に依存。Kotlin DSL の学習コストがチームの生産性に影響する可能性がある
  - D3（将来的なマルチモジュール化やカスタムビルドタスクの必要性）の判明により評価が変化する

### Maven with Maven Daemon

- 評価: △
- 利点:
  - Maven Daemon により JVM 起動コストを削減し、繰り返しビルドのパフォーマンスを改善できる
  - Maven のエコシステムの成熟度を維持しつつ、パフォーマンス向上を実現できる
  - Maven 4 への移行を見据えた場合、Maven Daemon 2.0.0-rc-3（プレビュー版）が既に提供されており、将来的な互換性が期待できる
- 欠点:
  - Maven Daemon はプレビュー版（2.0.0-rc-3）であり、本番環境での安定性が未検証
  - JVM 起動コスト削減の効果は限定的であり、Gradle のインクリメンタルビルドやビルドキャッシュには及ばない
  - research.md によれば、Maven のパフォーマンスは Gradle の約半分であり、Maven Daemon を導入しても根本的なパフォーマンス差は縮まらない
  - Maven 4 が Java 17 を必須とするため、Maven Daemon 2.0.0 も Java 17 環境が前提となる可能性がある
- 根拠:
  - research.md で Maven Daemon 1.0.3 および 2.0.0-rc-3 の存在が確認されている
  - JVM 起動コストの削減は理論的に有効だが、Gradle の Build Cache や Configuration Cache と比較すると効果が限定的
- CSD依存:
  - S6（Maven 4 は近い将来に正式リリースされる）に依存。Maven 4 への移行タイミングが遅れる場合、Maven Daemon 2.0.0 の安定版提供も遅れる可能性がある
  - D4（Maven 4 正式リリースのタイミングとプラグインエコシステムの移行状況）の判明により評価が変化する

### Maven 3.9.x (Standard)

- 評価: ×
- 利点:
  - 安定版 Maven 3.9.12 は成熟しており、ツールチェーンの安定性が高い
  - エコシステムの成熟度により、必要なプラグインが確実に利用可能（S9: 現時点で必要なプラグインは Maven/Gradle 両エコシステムで利用可能である）
  - チームが Maven に慣れている場合、学習コストが最小限（D1: チームの Gradle/Maven それぞれの習熟度）
- 欠点:
  - research.md によれば、Gradle は Maven の2倍以上高速であり、ビルドパフォーマンスの観点では明確に劣る
  - インクリメンタルビルド、ビルドキャッシュ、並列タスク実行の最適化が Gradle に劣るため、開発中の頻繁なビルドで生産性のボトルネックとなるリスクが高い
  - プロジェクト規模が成長した場合、ビルド時間の増大が避けられない（S2: プロジェクト規模は中規模以上になる見込みである）
  - Maven 4 への移行を見据えた場合、Java 17 必須の制約により移行タイミングの調整が必要
- 根拠:
  - research.md の複数の出典で一貫して Maven のパフォーマンスが Gradle に劣ることが示されている
  - OBJ-2（ビルドパフォーマンス）を最優先する場合、Maven 3.9.x (Standard) はパフォーマンス要件を満たさない
- CSD依存:
  - S3（ビルド時間はプロジェクトの生産性に影響する）に依存。ビルド頻度が低い場合、パフォーマンス差が実質的な影響を持たない可能性がある
  - D2（プロジェクトの具体的な規模とビルド頻度）の判明により評価が変化する。規模が小さくビルド頻度が低い場合、パフォーマンス差が許容範囲内となる可能性がある
