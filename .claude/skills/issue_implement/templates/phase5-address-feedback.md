以下の手順でPRフィードバックに基づいてコードを修正してください:

## 手順

### 1. 設計の把握

{design_path} を Read で読み込み、設計仕様を把握する。

### 2. 実装計画の把握

{plan_path} を Read で読み込み、各ステップの変更内容を把握する。

### 3. PRフィードバックの把握

{feedback_path} を Read で読み込み、全コメントを把握する。
各コメントの `comment_id` を保持し、対応サマリにそのまま記録すること。

### 4. エラーコンテキストの確認（リトライ時のみ）

{error_context} が「なし」でない場合:
- 前回のエラー内容を確認する
- エラーの原因を分析する
- 修正方針を立てる（同じアプローチを繰り返さない）

### 5. コメント分類

各コメントを以下のカテゴリに分類する:
- **code_fix**: コード修正が必要（バグ指摘、ロジック変更、パフォーマンス改善等）
- **test_fix**: テスト修正が必要（テスト追加、テストケース修正等）
- **clarification**: コメントへの説明・回答が必要（修正不要）
- **acknowledged**: 対応不要（情報提供、賛同等）

### 6. コード修正

code_fix と test_fix のコメントに対してコードを修正する:

- **設計との整合性を維持する**: 修正が設計仕様に矛盾しないことを確認する
- **既存コードの規約に合わせる**: 命名規約・コーディングスタイルを維持する
- **テストも修正する**: テスト関連の指摘がある場合はテストコードも修正する
- **修正不可能なコメント**: 設計上の制約等で対応できない場合は、理由を記録する

### 7. 対応サマリの保存

{reply_save_path} に Write で保存する:

```markdown
# フィードバック対応サマリ

## コード修正

### {コメント要約1}
- comment_id: {コメントのcomment_id}
- 対応内容: {修正内容}
- 変更ファイル: {ファイルパス}

### {コメント要約2}
- comment_id: {コメントのcomment_id}
- 対応内容: {修正内容}
- 変更ファイル: {ファイルパス}

## 説明・回答

### {コメント要約}
- comment_id: {コメントのcomment_id}
- 回答: {回答内容}

## 対応不要

### {コメント要約}
- comment_id: {コメントのcomment_id}
- 理由: {対応不要の理由}
```

各セクションの項目が 0 件の場合は「なし」と記載する。

### 8. 返答

以下のフォーマットで返答する:

```
result: success
code_fixed: {コード修正したコメント数}
clarified: {説明・回答のコメント数}
no_action: {対応不要のコメント数}
files_list: {変更した全ファイルの絶対パスを1行1ファイルで列挙（変更なしの場合は「なし」）}
summary: {修正内容の1行サマリ}
```
