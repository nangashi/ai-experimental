# 観点定義: 信頼性・運用性（設計レビュー）

## 概要
設計書の障害耐性と運用性を評価する。障害発生時のシステムの振る舞い、回復能力、監視可能性、デプロイ安全性を重点的に評価する。セキュリティ（悪意ある攻撃）やパフォーマンス（正常時の効率）とは異なり、「偶発的な障害に対してシステムが正しく振る舞い、運用チームが適切に対応できるか」を評価する。

## 評価スコープ
- 障害回復設計（サーキットブレーカー、リトライ戦略、タイムアウト設計、フォールバック戦略、バックプレッシャー/自己保護目的のレート制限、障害分離境界（バルクヘッドパターン））
- データ整合性・べき等性（データ一貫性保証戦略（トランザクション管理、分散環境での整合性確保）、べき等性設計、重複検出メカニズム）
- 可用性・冗長性・災害復旧（単一障害点の特定と対策、フェイルオーバー設計、グレースフルデグラデーション、冗長性設計（規模に応じたプロセス・ノード・リージョンレベル）、依存関係の障害影響分析、バックアップ戦略、RPO/RTO定義）
- 監視・アラート設計（SLO/SLA定義、メトリクス収集設計（REDメトリクス：リクエストレート・エラー率・レイテンシ、リソース使用率）、アラート戦略（SLOベースの閾値設定、アラートルーティング/エスカレーション）、ヘルスチェック設計）
- デプロイ・ロールバック（デプロイ戦略、ロールバック計画、データマイグレーションの後方互換性、フィーチャーフラグによる段階的リリース）

## スコープ外
- 悪意ある攻撃への耐性（DoS攻撃、ブルートフォース等）→ security で扱う
- 正常時のリソース効率（クエリ最適化、キャッシュ戦略等）→ performance で扱う
- オブザーバビリティの設計原則（トレーシング、メトリクス計装の設計パターン）→ structural-quality で扱う / 運用上のSLO/SLA監視・アラートルール設計 → reliability で扱う
- エラーハンドリングの設計原則（エラー分類・伝播方式）、ロギングのアーキテクチャ設計（構造化ログ、ログレベル設計）→ structural-quality で扱う
- 既存コードとの規約一致 → consistency で扱う

## ボーナス/ペナルティの判定指針
- **ボーナス対象**: SPOFの特定、べき等性の欠如、監視の盲点、災害復旧計画の欠如など正解キーに含まれない運用上の問題の検出
- **ペナルティ対象**: セキュリティ脆弱性、コーディングスタイル、エラーハンドリングの設計原則（structural-qualityの管轄）の指摘
- **判断に迷うケース**: (a) レート制限 → 自己保護（バックプレッシャー）目的はスコープ内、攻撃防御目的は security。(b) デプロイ戦略の設計原則（blue-green等の選定根拠）→ structural-quality、具体的なロールバック手順・RPO/RTOとの整合 → reliability。(c) 分散トレーシング・相関ID → 障害調査のための運用ツールとしてスコープ内、ログフォーマット・レベル設計は structural-quality

## 問題バンク

以下は埋め込み可能な問題のカテゴリと例。実際の埋め込み時はこれらを参考にしつつ、テスト対象文書の文脈に合った具体的な問題を作成する。

**深刻度の定義**: 重大=全体障害・データ損失リスク、中=部分障害・回復困難、軽微=運用改善の余地

| カテゴリ | 問題例 | 深刻度 |
|---------|--------|-------|
| 障害回復設計 | 外部API呼び出しにサーキットブレーカーもリトライ戦略もない | 重大 |
| データ整合性 | 複数サービス間トランザクションの一貫性保証が未設計 | 重大 |
| 可用性・冗長性 | 単一障害点（SPOF）の特定と対策が未設計 | 重大 |
| 障害回復設計 | サービス間通信のタイムアウト仕様が未定義 | 中 |
| データ整合性 | リトライ可能な操作のべき等性が未設計 | 中 |
| 可用性・冗長性 | 依存サービスのSLA前提が未定義で、SLA連鎖の影響が未分析 | 中 |
| 監視・アラート | SLO/SLAに対応する監視・アラート設計がない | 中 |
| 監視・アラート | 障害検知後のインシデント対応手順（ランブック、エスカレーションパス）が未定義 | 中 |
| デプロイ・ロールバック | ゼロダウンタイムデプロイ戦略の欠如 | 軽微 |
| 可用性・冗長性 | 長時間バッチ処理の中断・再開設計がない | 軽微 |
