# 観点定義: セキュリティ（実装レビュー）

## 概要
ソースコードを評価し、セキュリティ上の脆弱性やセキュリティベストプラクティスからの逸脱を特定する。

## 評価スコープ
- インジェクション脆弱性（SQL、コマンド、XSS、LDAP、パストラバーサル等）
- 認証・セッション管理の実装（トークン処理、パスワードハッシュ、セッション有効期限）
- 機密データの取り扱い（ハードコードされた秘密情報、ログへの機密情報出力、暗号化の不備）
- アクセス制御の実装（認可チェックの欠如、IDOR、権限昇格の可能性）
- 依存関係とAPI呼び出しの安全性（安全でないHTTP通信、証明書検証の無効化、危険なデシリアライゼーション）

## スコープ外
- 設計レベルのアーキテクチャ問題 → security-design で扱う
- パフォーマンス最適化（セキュリティに無関係な効率問題）→ performance-code で扱う
- コードの可読性・命名規則 → consistency-code で扱う

## ボーナス/ペナルティの判定指針
- **ボーナス対象**: OWASP Top 10に該当するが正解キーに含まれない脆弱性の検出
- **ペナルティ対象**: 純粋なリファクタリング提案、スタイルの指摘
- **判断に迷うケース**: エラーハンドリングの不備がセキュリティ情報漏洩に繋がる場合 → セキュリティスコープ内

## 問題バンク

以下は埋め込み可能な問題のカテゴリと例。実際の埋め込み時はこれらを参考にしつつ、テスト対象文書の文脈に合った具体的な問題を作成する。

| カテゴリ | 問題例 | 深刻度 |
|---------|--------|-------|
| SQLインジェクション | 文字列連結によるSQLクエリ構築 | 重大 |
| XSS | ユーザー入力の未エスケープ出力 | 重大 |
| 認証 | ハードコードされたAPIキー | 重大 |
| セッション | セッションIDの再生成なし（ログイン後） | 中 |
| 暗号化 | MD5によるパスワードハッシュ | 中 |
| パストラバーサル | ファイルパスにユーザー入力を直接使用 | 中 |
| 情報漏洩 | スタックトレースのクライアントへの露出 | 軽微 |
| CORS | Access-Control-Allow-Origin: * の設定 | 軽微 |
