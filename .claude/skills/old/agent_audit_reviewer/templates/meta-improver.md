以下の手順でプロンプト改善バリアントを生成してください:

## 入力の読み込み

1. Read で以下のファイルを読み込む:
   - {current_best_path} （現在のベストプロンプト — 全文を理解する）
   - {history_path} （最適化履歴 — 特に以下のセクションに注目する）:
     - 「Current Error Analysis」: 現在のベストが見逃しているカテゴリと、プロンプトのどのギャップが原因か
     - 「Round History」: 過去の変更とその効果
     - 「Effective Changes」: 過去に効果があった変更パターン
     - 「Ineffective Changes」: 過去に効果がなかった変更パターン（**これらと同類の変更は避けること**）
   - {proven_insights_path} （エージェント横断の知見 — Error→Fix パターンを参考にする）
   - {proven_techniques_path} （agent_bench の実証済みテクニック — アンチパターン回避に使用）
   - {perspective_path} （観点定義 — エージェントの評価スコープを理解する）

## 分析フェーズ

2. 現在のベストプロンプトを以下の観点で分析する:
   - **アイテム識別力**: history の「Item Analysis」テーブルを確認する。**識別力「高」の問題を優先的な改善対象とする**（プロンプト変更の効果が最も反映される）。識別力「低（天井）」の問題は既に十分検出されているので対象外。識別力「低（床）」の問題はプロンプト変更だけでは改善困難な可能性が高いので優先度を下げる
   - **見逃しパターン**: error analysis の「Missed/Partial by Category」テーブルと「Prompt Gap」列を照合し、プロンプトのどの部分が不十分かを特定する
   - **強み**: error analysis の「Strengths to Preserve」を確認し、変更してはいけない要素を特定する
   - **改善方向**: error analysis の「Improvement Directions」を確認する
   - **過去の失敗**: history の「Ineffective Changes」に該当する変更を避ける
   - **クロスエージェント知見**: proven-insights.md の Error→Fix Patterns から、現在のエラーカテゴリに適用可能な fix パターンを検索する。proven-techniques.md の「回避すべきアンチパターン」に該当する変更を除外する

3. 以下の戦略メニューから、今回のラウンドで使用する戦略を2つ選択する:

   | # | 戦略 | 説明 | 適用条件 |
   |---|------|------|---------|
   | S1 | コンテンツ追加 | 不足カテゴリのチェック項目を追加 | 明確なプロンプトギャップがあり、追加による他カテゴリ退化リスクが低い場合 |
   | S2 | 構造再編 | セクション順序・グルーピング変更で注意力配分を改善 | 複数カテゴリで検出低下が繰り返される場合 |
   | S3 | 圧縮+置換 | 既存の冗長な記述を圧縮し、新しい指示のためのトークン予算を確保 | プロンプトが長く追加のたびに他カテゴリが退化する場合 |
   | S4 | 優先度キューイング | 重要度/検出難易度に応じた明示的な優先順位指示を追加 | 重要カテゴリの安定検出が必要な場合 |
   | S5 | メタ指示 | 「全カテゴリを均等に評価せよ」等の高レベル行動指示の追加/修正 | 特定カテゴリへの注意偏りが繰り返される場合 |

   **戦略選択の制約:**
   - 2つの戦略は異なるものを選択すること
   - Ineffective Changes に同タイプの変更（例: チェックリスト追加）が2回以上ある場合、その戦略は選択しないこと
   - 各戦略の選択理由を1行で記録すること

4. Step 3 で選択した各戦略に基づき、改善方針を2つ策定する。各方針は:
   - **選択した戦略の手法を適用すること**（S1なら項目追加、S2なら構造変更、S3なら圧縮、等）
   - error analysis で特定された具体的なプロンプトギャップを対象とすること
   - 過去に失敗した変更と同類でないこと
   - proven-techniques.md のアンチパターンに該当しないこと
   - 強みを保持しつつ弱点を補強するアプローチであること
   - 2つの方針は異なる戦略から選択されていること

## 副作用予測フェーズ

5. 各方針について以下の副作用分析を実行する:

   **方針1（{戦略名}）:**
   - トークン影響: 増加/減少/変化なし（概算行数の増減）
   - 検出リスク: この変更で検出性能が低下しうるカテゴリと、その理由
   - 失敗パターン類似性: Ineffective Changes の既存エントリと構造的に類似するか（Yes/No + 根拠）
   - 予想 net effect: 改善カテゴリのスコア増 vs リスクカテゴリのスコア減の見積もり

   **方針2（{戦略名}）:**
   - （同上のフォーマットで分析）

   **修正判定:**
   - 失敗パターン類似性が Yes の場合: 方針を別の戦略に切り替えるか、対象ギャップを変更する
   - 予想 net effect が負の場合: 方針を修正するか、リスクを軽減する追加措置（例: 圧縮との併用）を検討する
   - 修正した場合は修正後の方針を記録する

## 生成フェーズ

6. 各方針に基づき、ベストプロンプトを改変して2つのバリアントを生成する:
   - **変更は最小限にする**: エラー分析で特定された問題に直接対処する変更のみ行う。無関係な部分は変えない
   - **YAML frontmatter、ロール定義、ドメイン固有用語は保持する**
   - **元プロンプトの言語を維持する**（言語変更は明示的な方針の場合のみ）
   - 各バリアントのファイル先頭に以下の Benchmark Metadata コメントを記載する:
     ```
     <!-- Benchmark Metadata
     Round: {round_number}
     Base: {current_best_path のファイル名}
     Strategy: {使用した戦略: S1-S5}
     Change: {変更内容の1行要約}
     Target: {対象とする error analysis のカテゴリ}
     Rationale: {なぜこの変更が効果的と考えるか}
     Side-effect-risk: {Step 5 の検出リスクの要約}
     -->
     ```

7. **交叉バリアント生成（条件付き）:**
   以下の条件を**すべて**満たす場合のみ、3つ目の交叉バリアントを生成する:
   - history の Effective Changes テーブルにエントリが2つ以上ある
   - それらの変更が互いに独立したカテゴリを対象としている

   生成手順:
   a. Effective Changes テーブルから効果が高い順に2つの変更を選択する
   b. 各変更の内容をベストプロンプトに対して**同時に**適用する
   c. 変更が競合する場合（同じセクションを修正する場合）は、効果が高い方を優先する

   Benchmark Metadata:
   ```
   <!-- Benchmark Metadata
   Round: {round_number}
   Base: {current_best_path のファイル名}
   Strategy: crossover
   Change: {変更1の要約} + {変更2の要約}
   Target: {対象カテゴリ1}, {対象カテゴリ2}
   Rationale: 過去の成功パターンの組み合わせによる複合改善
   Source-changes: R{N1}:{change1}, R{N2}:{change2}
   -->
   ```

   条件を満たさない場合は、このステップをスキップする。

8. Write で以下に保存する:
   - {prompts_dir}/v{NNN}-variant-{name1}.md （NNN = round_number + 1、name は変更内容を反映した短い名前）
   - {prompts_dir}/v{NNN}-variant-{name2}.md
   - （交叉バリアントを生成した場合）{prompts_dir}/v{NNN}-variant-crossover.md

9. 以下のフォーマットで結果サマリのみ返答する（プロンプト本文は含めない）:

## 分析結果
- 主要な見逃しカテゴリ: {カテゴリ名のリスト}
- 特定したプロンプトギャップ: {ギャップの説明}
- 保持すべき強み: {強みのリスト}

## 選択した戦略
1. {戦略名}: {選択理由1行}
2. {戦略名}: {選択理由1行}

## 副作用分析サマリ
- 方針1: net effect {正/負/中立}, リスク: {高/中/低}
- 方針2: net effect {正/負/中立}, リスク: {高/中/低}

## 生成したバリアント
- variant_count: {2 or 3}
1. v{NNN}-variant-{name1}.md
   - 戦略: {S1-S5}
   - 対象ギャップ: {error analysis のどのカテゴリ/ギャップに対処}
   - 変更内容: {具体的な変更の説明}
   - 仮説: {期待される効果}
   - 参考知見: {proven-insights/techniques からの根拠があれば}
2. v{NNN}-variant-{name2}.md
   - 戦略: {S1-S5}
   - 対象ギャップ: {同上}
   - 変更内容: {同上}
   - 仮説: {同上}
   - 参考知見: {同上}
3. （交叉バリアントがある場合）v{NNN}-variant-crossover.md
   - 戦略: crossover
   - 組み合わせ元: {R{N1}:{change1}, R{N2}:{change2}}
   - 変更内容: {統合された変更の説明}
   - 仮説: {期待される効果}
