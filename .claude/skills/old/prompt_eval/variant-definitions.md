# バリエーション定義

このファイルは、対象プロンプトから10個の構造的バリエーションを生成するための変換ルールを定義する。
各バリエーションは **1つの独立変数のみを変化** させ、他の要素は元のプロンプトから変更しない。

## 共通ルール

- 元プロンプトの**言語**（日本語/英語）はそのまま維持する
- 元プロンプトの**役割定義**（冒頭の役割説明）は、バリエーションBを除き変更しない
- 元プロンプトの**ドメイン固有の用語**はそのまま維持する
- 独立変数以外の要素を変更してはならない（統制変数の維持）

---

## Variant A: ベースライン

- **独立変数**: なし
- **変換ルール**: 元のプロンプトをそのまま使用する。比較の基準となる。
- **生成時の注意**: 一切の変更を加えない。frontmatter がある場合はそれも含める。

---

## Variant B: ミニマル

- **独立変数**: 全構造を最小化
- **変換ルール**:
  1. 元プロンプトから以下の3要素のみを抽出する:
     - **役割定義**: 冒頭の1-2文（「あなたは〜です。」の部分）
     - **タスク指示**: 何をすべきかの1文（「〜してください。」）
     - **最小出力形式**: 出力に含めるべき項目名の箇条書き（各1行、説明なし）
  2. それ以外のセクション（原則、詳細な手順、制約、注意事項等）を全て削除する
  3. 全体を20-30行以内に収める
- **生成時の注意**: タスクの目的が変わらないよう、最小限の情報は維持する

---

## Variant C: 見出し削減

- **独立変数**: トップレベルのカテゴリ数（削減方向）
- **変換ルール**:
  1. 元プロンプトのトップレベルセクション（`##` レベル）を特定する
  2. 意味的に近いセクションを統合し、**3つのカテゴリ**にまとめる
     - 統合の方針: 関連する観点をグループ化する（例: セキュリティ+エラーハンドリング、パフォーマンス+スケーラビリティ、設計原則+保守性+一貫性）
  3. 各統合カテゴリ内のサブ項目は、元の全項目を維持する（削除しない）
  4. 統合後のカテゴリ名は、含まれる内容を包括的に表すものにする
- **生成時の注意**: サブ項目の内容は変えず、見出しの構成のみ変更する

---

## Variant D: 見出し拡張

- **独立変数**: トップレベルのカテゴリ数（拡張方向）
- **変換ルール**:
  1. 元プロンプトのトップレベルセクションを特定する
  2. **8つのカテゴリ**に拡張する
     - 既存のカテゴリを分割する（例: 「設計原則」→「SOLID原則」+「デザインパターン」）
     - 元プロンプトに暗黙的に含まれている観点を独立カテゴリとして追加する（例: 「テスト戦略」「API設計」「依存関係管理」）
  3. 追加カテゴリのサブ項目は、元プロンプトの他セクションから関連する記述を移動して構成する
  4. 新たな内容の追加は最小限にし、既存の記述の再構成を主とする
- **生成時の注意**: 新規追加する内容は元プロンプトの文体・粒度に合わせる

---

## Variant E: 骨格のみ

- **独立変数**: サブ項目の粒度（最小化）
- **変換ルール**:
  1. 元プロンプトの全セクション見出し（`##`, `###` レベル）を維持する
  2. 各セクション内の **箇条書き、説明文、注意書きを全て削除** する
  3. 見出し名のみの骨格構造にする
  4. 役割定義（冒頭）と出力形式セクションは維持する
- **生成時の注意**: 見出しの文言自体は変更しない。削除対象は見出し直下の本文のみ。

---

## Variant F: 詳細記述

- **独立変数**: サブ項目の粒度（最大化）
- **変換ルール**:
  1. 元プロンプトの各サブ項目に対して、以下の3要素を追加する:
     - **確認用の問い**: その項目を確認するための具体的な質問（例: 「入力データのバリデーションは境界値を含めて検証されているか？」）
     - **アンチパターン例**: よくある失敗例（例: 「❌ SQLクエリにユーザー入力を直接結合している」）
     - **判断基準**: どの程度であれば問題とするかの閾値（例: 「N+1クエリが3回以上のループで発生する場合は重大」）
  2. 元の箇条書き項目の文言はそのまま維持する
  3. 追加する内容は各項目につき3-5行を目安とする
- **生成時の注意**: 追加内容は元プロンプトの文体に合わせる。過度に冗長にならないよう注意。

---

## Variant G: 出力形式簡略

- **独立変数**: 出力テンプレートの詳細度（最小化）
- **変換ルール**:
  1. 元プロンプトの出力形式セクション（テンプレート、フォーマット指定、構造化指示）を全て削除する
  2. 代わりに以下の1文のみに置き換える:
     > 発見した問題点を列挙してください。
  3. 元プロンプトの他のセクション（役割定義、評価観点、原則等）は変更しない
- **生成時の注意**: 出力フォーマットに関する記述を漏れなく削除する。ただしタスク指示自体は残す。

---

## Variant H: 分析手順明示（Chain-of-Thought）

- **独立変数**: 段階的分析ステップの有無
- **変換ルール**:
  1. 元プロンプトに以下の「分析手順」セクションを追加する（役割定義の直後、評価観点の前に挿入）:
     ```
     ## 分析手順

     以下のステップに従って段階的に分析してください:

     ### ステップ1: 全体構造の把握
     まず入力全体を通読し、全体のアーキテクチャ、コンポーネント構成、データフローを把握してください。

     ### ステップ2: データフローの追跡
     入力から出力までのデータの流れを追跡し、各コンポーネント間のインターフェースと依存関係を特定してください。

     ### ステップ3: 観点別の詳細分析
     各評価観点（セキュリティ、パフォーマンス等）について、ステップ1-2の理解を基に問題点を洗い出してください。

     ### ステップ4: 影響範囲の評価
     検出した各問題について、影響範囲と深刻度を評価してください。

     ### ステップ5: 結果の整理
     全ての分析結果を構造化して出力してください。
     ```
  2. 元プロンプトの他のセクションは変更しない
- **生成時の注意**: 追加するステップは元プロンプトの文体・言語に合わせる。

---

## Variant I: 具体例付き（Few-shot）

- **独立変数**: 出力例の有無
- **変換ルール**:
  1. 元プロンプトに「出力例」セクションを追加する（出力形式セクションの直後に挿入）:
  2. **3つの指摘例** を含める。各例は以下の構造とする:
     - 例1: **セキュリティ**に関する良い指摘例（重大な問題の指摘）
     - 例2: **パフォーマンス**に関する良い指摘例（中程度の問題の指摘）
     - 例3: **設計原則**に関する良い指摘例（軽微な問題の指摘）
  3. 各例は元プロンプトの出力形式に準拠したフォーマットで記述する
  4. 例の内容はテスト入力の問題とは**異なるもの**にする（回答の漏洩を防ぐ）
     - 例: XSS脆弱性、キャッシュ欠如、不適切な継承 など
  5. 元プロンプトの他のセクションは変更しない
- **生成時の注意**: 例はリアルで具体的なものにする。テスト入力に埋め込んだ問題と重複しないよう注意。

---

## Variant J: 定量スコアリング

- **独立変数**: 数値評価基準の有無
- **変換ルール**:
  1. 元プロンプトに「スコアリング基準」セクションを追加する:
     ```
     ## スコアリング基準

     各評価観点について、以下の5段階で評価し、スコアを出力に必ず含めてください:

     | スコア | 基準 |
     |-------|------|
     | 5 | 問題なし: ベストプラクティスに完全に準拠 |
     | 4 | 軽微な改善余地: 動作に影響しないが、改善が望ましい |
     | 3 | 中程度の問題: 将来的にリスクとなる可能性がある |
     | 2 | 重要な問題: 本番環境で問題を引き起こす可能性が高い |
     | 1 | 重大な問題: 即時の対応が必要 |

     ### 必須出力: スコアサマリ
     全観点のスコアを以下の表形式で出力してください:

     | 観点 | スコア (1-5) | 主な理由 |
     |-----|-------------|---------|
     | (各観点) | (スコア) | (1文で理由) |
     | **総合** | **(平均)** | |
     ```
  2. 元プロンプトの出力形式セクションに「スコアサマリ表を必ず含めること」を追記する
  3. 元プロンプトの他のセクションは変更しない
- **生成時の注意**: スコアリング基準の文体は元プロンプトに合わせる。

---

## 構造次元ごとの対比関係

各バリエーションは以下の構造次元に対応する。分析時はこの対比関係を参照すること。

```
見出し数:        C(3カテゴリ) ← A(現状) → D(8カテゴリ)
サブ項目粒度:    E(見出しのみ) ← A(現状) → F(詳細記述)
出力形式詳細度:  G(自由形式) ← A(現状) → J(スコアリング付き)
分析手順:        A(暗黙的) → H(明示的ステップ)
具体例:          A(なし) → I(3例付き)
全体量:          B(最小) ← A(中) → F/D(最大)
```
