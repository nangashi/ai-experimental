以下の手順で実装コードのレビューを実行してください:

## 手順

### 1. レビュー指示の読み込み

{agent_definition_path} を Read で読み込み、レビューの観点・評価基準・分析手順を把握する。

### 2. 設計の把握

{design_path} を Read で読み込み、設計意図を把握する。特に:
- コンポーネント構成
- API/インターフェース仕様
- 処理フロー
- エラーハンドリング方針

### 3. 実装計画の把握

{plan_path} を Read で読み込み、各ステップの変更内容を把握する。

### 4. 変更差分の把握

{diff_path} を Read で読み込み、変更されたファイルと変更内容を把握する。

### 5. コードの確認

diff に含まれる変更ファイルを Read で確認し、実際のコード全体を把握する。変更箇所だけでなく、周辺のコンテキストも確認する。

### 6. レビュー実行

レビュー指示に従い、実装コードをレビューする:

- 評価基準の各項目に照らしてコードを分析する
- 設計仕様との整合性を確認する
- 指摘には具体的なファイルパス・行番号・根拠・改善案を含める

### 7. 結果の保存

レビュー結果を以下のフォーマットで {findings_save_path} に Write で保存する:

```markdown
# コードレビュー: {perspective}

## Critical

{重大な問題。ランタイムエラー、データ破損、セキュリティ脆弱性など。なければ「なし」}

各指摘のフォーマット:
### {指摘タイトル}
- **ファイル**: {ファイルパス:行番号}
- **内容**: {問題の説明}
- **影響**: {この問題が引き起こす具体的な影響}
- **推奨**: {改善案（コード例があれば含める）}

## Significant

{重要な問題。本番環境で問題を引き起こす可能性が高いもの。なければ「なし」}

（Critical と同じフォーマット）

## Moderate

{中程度の問題。特定条件下で問題となるもの。なければ「なし」}

（同フォーマット、影響は簡略可）

## Minor

{軽微な改善提案。なければ「なし」}

- {改善提案}

## 総合評価

verdict: {pass / needs_revision}
reason: {判定理由}
```

判定基準:
- Critical が 1件以上 → `needs_revision`
- Significant が 2件以上 → `needs_revision`
- それ以外 → `pass`

### 8. 返答

以下のフォーマットで返答する:

```
perspective: {perspective}
critical: {Critical の件数}
significant: {Significant の件数}
verdict: {pass / needs_revision}
summary: {レビュー結果の1行サマリ}
```
