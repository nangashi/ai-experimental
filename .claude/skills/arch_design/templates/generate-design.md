以下の手順で設計文書を生成してください:

## 手順

### 1. テンプレートの読み込み

{template_path} を Read で読み込み、出力フォーマットと記入ガイダンスを把握する。

### 2. 要件の把握

{requirements_path} を Read で読み込み、以下を把握する:
- 機能要件（SR一覧）
- 非機能要件（NFR一覧）
- インターフェース要件（IR一覧）
- 制約
- ユースケース一覧
- システム境界（アクター、外部インターフェース）

### 3. 設計決定事項の把握

{decisions_path} を Read で読み込み、全ての確定済み設計決定を把握する。

### 4. ADRの参照

{adr_dir} を Glob で確認し、存在するADRファイルの「決定」セクションを Read で把握する。

### 5. 設計文書の生成

テンプレートに従い、要件・設計決定・ADR情報を統合して設計文書を生成する。

生成ルール:
- 各セクションで関連するSR/NFR/IRへのトレースを記載する
- ADRが存在する技術決定はADRファイルへの参照を含める（例: `ADR-0001`）
- 「該当なし」のセクションは省略せず「該当なし」と明記する
- データモデルのスキーマは具体的な型・制約を含める
- APIエンドポイントはHTTPメソッド・パス・リクエスト/レスポンス形式を含める
- 曖昧な記述（「適切に処理する」等）を避け、具体的な方式・パターンを記述する
- **実装詳細の排除**: 具体的なSQL文・コードスニペット・特定APIメソッド名（例: `.ilike()`, `AbortController`, CTE構文）を含めない。設計方針・制約・パターン名のみ記載し、具体的な実装手段は実装フェーズに委ねる

### 6. トレーサビリティテーブルの生成

設計文書の末尾に「要件トレーサビリティ」セクションを生成する:

1. {requirements_path} から全 SR-ID を列挙し、「機能要件カバレッジ」テーブルに対応するコンポーネント・API・データを記入する
2. {requirements_path} から全 NFR-ID を列挙し、「非機能要件への対応」テーブルに対応する設計要素・実現方法を記入する
3. 対応なしの場合は「対応なし」と明記する（省略禁止）

### 7. 保存

生成した設計文書を {output_save_path} に Write で保存する。ステータスは `Draft` とする。

### 8. 返答

以下のフォーマットで返答する:

```
result: success
sections_completed: {完了セクション数}
sr_coverage: {対応済みSR数}/{全SR数}
nfr_coverage: {対応済みNFR数}/{全NFR数}
adr_references: {参照したADRファイル名リスト（なければ「なし」）}
```
