# スキル構造分析テンプレート

以下の手順でスキルの構造を分析し、レビューアーが使用する分析ドキュメントを生成してください。

## パス変数
- `{skill_path}`: スキルディレクトリの絶対パス
- `{skill_name}`: スキル名
- `{file_list}`: スキル内の全 .md ファイルパスリスト
- `{analysis_save_path}`: 分析結果の保存先パス

## 手順

1. `{skill_path}/SKILL.md` を Read で読み込む
2. `{file_list}` の各ファイルを Read で読み込む（20ファイル超の場合は SKILL.md + templates/ ディレクトリ内を優先し、残りは先頭5ファイルのみ読み込む）
3. 以下の構造で分析ドキュメントを生成する

## 分析ドキュメントの構造

```markdown
# スキル構造分析: {skill_name}

## A. ファイルインベントリ
| ファイル | 行数 | 役割 |
|---------|------|------|
（全ファイルを列挙。Read できなかったファイルは「未読」と記載）

## B. ワークフロー概要
- フェーズ構成: Phase X → Y → Z
- 各フェーズの目的（1行ずつ）
- データフロー: どのフェーズがどのファイルを生成し、どのフェーズが参照するか

## C. 外部参照の検出
（{skill_path} 外のパスを参照する箇所を全て列挙）
| ファイル | 行番号 | 参照先パス | 用途 |
|---------|--------|-----------|------|
（外部参照がない場合は「なし」と記載）

## D. コンテキスト予算分析
- SKILL.md 行数: N行
- テンプレートファイル数: N個、平均行数: N行
- サブエージェント委譲: あり/なし（委譲パターンの概要）
- 親コンテキストに保持される情報: （種類を列挙）
- 3ホップパターンの有無: あり/なし（該当箇所を記載）

## E. ユーザーインタラクションポイント
| フェーズ | ツール | 目的 | Fast mode での扱い |
|---------|--------|------|-------------------|
（AskUserQuestion の呼び出し箇所を全て列挙。Fast mode 列は記載があれば記入、なければ「不明」）

## F. エラーハンドリングパターン
- ファイル不在時: （処理内容、または「未定義」）
- サブエージェント失敗時: （処理内容、または「未定義」）
- 部分完了時: （処理内容、または「未定義」）
- 入力バリデーション: （処理内容、または「未定義」）

## G. サブエージェント一覧
| フェーズ | モデル | テンプレート | 返答行数 | 並列数 |
|---------|--------|------------|---------|--------|
（Task ツール呼び出し箇所を全て列挙）
```

4. Write で `{analysis_save_path}` に保存する

5. 以下のフォーマットで**サマリのみ**返答する（詳細は analysis ファイルを参照）:
```
files: {ファイル数}
lines: {SKILL.md行数}
phases: {フェーズ数}
external_refs: {外部参照数}
checkpoints: {ユーザーチェックポイント数}
```
