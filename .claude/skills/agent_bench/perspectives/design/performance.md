# 観点定義: パフォーマンス（設計レビュー）

## 概要
設計書をアーキテクチャレベルで評価し、パフォーマンス上のボトルネックや非効率な設計を特定する。スケーラビリティ、レイテンシ、スループット、リソース効率の観点から、システムの性能要件を満たすための設計上の問題を検出する。

## 評価スコープ
- アルゴリズム・データ構造の効率性（ユースケースの要件（検索頻度、挿入/削除頻度、メモリ制約）に対して計算量が最適なデータ構造の選択）
- I/O・ネットワーク効率（N+1問題、バッチ処理設計、API呼び出しの効率（呼び出し回数の最小化、バッチAPI活用、接続プール））
- キャッシュ・メモリ管理（キャッシュ対象の選定（頻繁にアクセスされ変更頻度が低いデータ、計算コストの高い結果の選定）、有効期限、無効化戦略、メモリリーク防止、コネクションプール、リソース解放）
- レイテンシ・スループット設計（非同期処理、並列化、インデックス設計、パフォーマンス要件/SLA定義）
- スケーラビリティ設計（水平/垂直スケーリング方針、規模に応じたシャーディング戦略（該当する場合）、ステートレス設計）

## スコープ外
- セキュリティ脆弱性（DoS耐性に関連しないもの）→ security で扱う
- コーディング規約・命名規則 → consistency で扱う
- テスト設計・テスタビリティ → structural-quality で扱う
- リトライ・タイムアウト設計（障害回復目的）→ reliability で扱う
- 可用性・冗長性設計（パフォーマンス目的のスケーリング以外）→ reliability で扱う

## ボーナス/ペナルティの判定指針
- **ボーナス対象**: 設計書に記載のないが、ユースケース記述から推測可能なボトルネックの指摘（例: シングルインスタンス前提の設計だが将来のスケールアウト方針が未検討）
- **ペナルティ対象**: セキュリティやコーディングスタイルの指摘（パフォーマンスに無関係）
- **判断に迷うケース**:
  - 大量データのバリデーション処理 → パフォーマンススコープ内
  - リソース解放漏れ → パフォーマンス影響がある場合はパフォーマンススコープ内、設計パターンとしての問題は structural-quality
  - パフォーマンスメトリクスの収集設計（レスポンスタイム、スループット、リソース使用率）→ パフォーマンススコープ内、障害検知・アラート設計・SLO監視 → reliability
  - DoS耐性 → パフォーマンス観点から検出した場合はボーナス対象として報告可。セキュリティ観点が主目的の場合はスコープ外

## 問題バンク

以下は埋め込み可能な問題のカテゴリと例。実際の埋め込み時はこれらを参考にしつつ、テスト対象文書の文脈に合った具体的な問題を作成する。

| カテゴリ | 問題例 | 深刻度 |
|---------|--------|-------|
| パフォーマンス要件 | パフォーマンス目標値（レスポンスタイム、スループット）が未定義 | 重大 |
| クエリ効率 | N+1問題が発生するデータ取得設計 | 重大 |
| キャッシュ | 頻繁にアクセスされるデータにキャッシュ戦略がない | 重大 |
| データベース設計 | 大量データテーブルのパーティショニング/読み書き分離設計の欠如 | 中 |
| ロック戦略 | 高頻度更新データへのロック戦略が未設計（スループット低下リスク） | 中 |
| データ構造 | 大量データの検索にO(n)線形走査を前提とした設計 | 中 |
| 並行処理 | 大量データ処理に同期処理を使用する設計 | 中 |
| メモリ管理 | 長時間プロセスのメモリリーク防止設計が欠如 | 中 |
| 静的アセット | 静的アセット配信戦略の未考慮（CDN、圧縮、バンドル） | 軽微 |
| 監視 | パフォーマンス固有のメトリクス（レスポンスタイム、スループット、リソース使用率）の収集設計欠如 | 軽微 |
