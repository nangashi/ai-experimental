# 採点結果: v005-cors-bypass-output (doc2)

## スコアサマリ
Run1=11.0(検出10.0+bonus2-penalty0), Run2=11.5(検出10.0+bonus3-penalty0)

## 検出マトリクス
| ID | カテゴリ | 深刻度 | Run1 | Run2 |
|----|---------|--------|------|------|
| P01 | 認証・認可設計 | 重大 | ○ | ○ |
| P02 | インフラ・依存関係・監査 | 重大 | ○ | ○ |
| P03 | 認証・認可設計 | 重大 | ○ | ○ |
| P04 | 入力検証・攻撃防御 | 中 | ○ | ○ |
| P05 | 入力検証・攻撃防御 | 中 | ○ | ○ |
| P06 | 脅威モデリング（DoS/Spoofing） | 中 | ○ | ○ |
| P07 | データ保護 | 中 | ○ | ○ |
| P08 | データ保護 | 軽微 | ○ | ○ |
| P09 | インフラ・依存関係・監査 | 軽微 | ○ | ○ |
| P10 | インフラ・依存関係・監査 | 軽微 | ○ | ○ |

## カテゴリ別検出率
| Category | Questions | Rate | Detail |
|----------|-----------|------|--------|
| 認証・認可設計 | 2 | 1.00 | Run1: ○○ / Run2: ○○ |
| インフラ・依存関係・監査 | 3 | 1.00 | Run1: ○○○ / Run2: ○○○ |
| 入力検証・攻撃防御 | 2 | 1.00 | Run1: ○○ / Run2: ○○ |
| 脅威モデリング（DoS/Spoofing） | 1 | 1.00 | Run1: ○ / Run2: ○ |
| データ保護 | 2 | 1.00 | Run1: ○○ / Run2: ○○ |

## ボーナス・ペナルティ詳細
### Run1
- Bonus: B02（Stripe Webhook署名検証欠如: CRIT-04で偽イベントによる不正注文リスクを具体的に指摘）, B05（S3アップロードのMagicByte検証欠如: SIG-05でContent-Typeヘッダー偽装とマジックバイト検証の必要性を指摘）
- Penalty: なし

### Run2
- Bonus: B02（Stripe Webhook署名検証欠如: S-03で偽イベントリスクを具体的に指摘）, B03（注文詳細APIの所有権検証欠如: M-02でIDOR問題を指摘しオーナーシップ検証を提案）, B05（S3アップロードのMagicByte検証欠如: S-04でマジックバイト検証とContent-Type偽装リスクを指摘）
- Penalty: なし

## エラー分析（抽象的）

### Missed/Partial by Category
| Category | Problems | ○ | △ | × | Stability | Prompt Gap |
|----------|----------|---|---|---|-----------|------------|
| 認証・認可設計 | 2 | 4 | 0 | 0 | 高安定 | なし |
| インフラ・依存関係・監査 | 3 | 6 | 0 | 0 | 高安定 | なし |
| 入力検証・攻撃防御 | 2 | 4 | 0 | 0 | 高安定 | なし |
| 脅威モデリング（DoS/Spoofing） | 1 | 2 | 0 | 0 | 高安定 | なし |
| データ保護 | 2 | 4 | 0 | 0 | 高安定 | なし |

### Improvement Directions
全カテゴリで完全検出を達成しており、現時点で改善すべきギャップは観察されない。ただし、ボーナス問題（B01: STRIDEのRepudiation視点での認証失敗・ロール変更ログの欠落明示、B04: テナント別APIレート制限）は両Runで未検出であった。STRIDE各脅威カテゴリを体系的に列挙させるプロンプト要素を追加することで、Repudiationカテゴリの明示的なカバレッジが向上する可能性がある。また、テナント別のリソース消費制限（マルチテナントDoS）への言及を促す観点をプロンプトに含めることが有効と考えられる。

### Strengths to Preserve
- 全カテゴリで○判定（完全検出）を安定して達成しており、プロンプトの観点網羅性が高い
- 正規表現バイパスのような技術的詳細が必要な問題（P05: CORSバイパス）も正確に検出しており、攻撃手法の具体的な分析を促すプロンプト構造が有効に機能している
- 暗黙の省略（P08: PII保持期間、P10: 監査ログ分離）や矛盾する記述（P02: シークレット管理の矛盾）を含む難易度の高い問題も安定検出しており、設計書の一貫性チェックを促す観点が機能している
- Run2ではB03（IDOR）も検出し、ボーナス問題の獲得数が増加。認可チェックの詳細な設計要素への着目がより強化されていることを示す
