# 採点結果: v005-audit-log-gap-first (doc1)

## スコアサマリ
Run1=11.0(検出10.0+bonus2-penalty0), Run2=11.0(検出10.0+bonus2-penalty0)

## 検出マトリクス
| ID | カテゴリ | 深刻度 | Run1 | Run2 |
|----|---------|--------|------|------|
| P01 | 認証・認可設計 | 重大 | ○ | ○ |
| P02 | 認証・認可設計 | 重大 | ○ | ○ |
| P03 | データ保護 | 中 | ○ | ○ |
| P04 | データ保護 | 軽微 | ○ | ○ |
| P05 | 入力検証・攻撃防御 | 中 | ○ | ○ |
| P06 | 入力検証・攻撃防御 | 中 | ○ | ○ |
| P07 | 脅威モデリング（DoS/ブルートフォース） | 中 | ○ | ○ |
| P08 | インフラ・依存関係・監査 | 軽微 | ○ | ○ |
| P09 | 入力検証・攻撃防御 | 重大 | ○ | ○ |
| P10 | インフラ・依存関係・監査 | 軽微 | ○ | ○ |

## カテゴリ別検出率
| Category | Questions | Rate | Detail |
|----------|-----------|------|--------|
| 認証・認可設計 | 2 | 1.00 | Run1: ○○, Run2: ○○ |
| データ保護 | 2 | 1.00 | Run1: ○○, Run2: ○○ |
| 入力検証・攻撃防御 | 3 | 1.00 | Run1: ○○○, Run2: ○○○ |
| 脅威モデリング | 1 | 1.00 | Run1: ○, Run2: ○ |
| インフラ・依存関係・監査 | 2 | 1.00 | Run1: ○○, Run2: ○○ |

## ボーナス・ペナルティ詳細
### Run1
- Bonus:
  - B03相当: RedisリフレッシュトークンをユーザーIDキーで単一値保存する場合の複数デバイスセッション管理・強制無効化粒度の問題を指摘 [MINOR-1]
  - B04相当: 診断結果・処方内容等の高感度フィールドに対するアプリケーションレベル暗号化欠如を指摘 [MEDIUM-5]
- Penalty: なし

### Run2
- Bonus:
  - B03相当: RedisセッションキーのユーザーIDキーによる単一セッション設計の問題（複数デバイスセッション管理・強制無効化粒度）を指摘 [M-4]
  - 追加指摘: アクセストークン24時間有効期限がPHIプラットフォームとして過長であることを指摘（正解キー未掲載・スコープ内） [M-1]
- Penalty: なし

## エラー分析（抽象的）

### Missed/Partial by Category
| Category | Problems | ○ | △ | × | Stability | Prompt Gap |
|----------|----------|---|---|---|-----------|------------|
| 認証・認可設計 | 2 | 4 | 0 | 0 | 高安定 | なし |
| データ保護 | 2 | 4 | 0 | 0 | 高安定 | なし |
| 入力検証・攻撃防御 | 3 | 6 | 0 | 0 | 高安定 | なし |
| 脅威モデリング | 1 | 2 | 0 | 0 | 高安定 | なし |
| インフラ・依存関係・監査 | 2 | 4 | 0 | 0 | 高安定 | なし |

### Improvement Directions
全カテゴリで完全検出を達成しており、改善すべきギャップは検出されなかった。

両 Run ともに未検出・部分検出ゼロ（全問 ○）であり、プロンプトとしての検出能力は高水準に達している。今後の改善余地があるとすれば以下の方向性が考えられる:

- **深刻度の優先付け精度**: 重大・中・軽微の深刻度区別がより精確に表現されているか（今回は全問検出のため影響なし）
- **ボーナス指摘の一貫性**: 両 Run で同種のボーナス指摘が出ているが、指摘の深さに差異がある（Run1 は [MEDIUM-5] アプリケーションレベル暗号化を個別セクションとして詳述、Run2 は未指摘）

### Strengths to Preserve
- **監査ログカテゴリの細分化**: セキュリティイベントの種別（認証失敗・権限変更・機密データアクセス・一般ログ分離）を個別の独立した問題として指摘できている。これは「Audit Log Gap First」の構造的誘導が有効に機能していることを示す。
- **認可問題の具体性**: ロールベースアクセスの横断アクセス問題をテナント境界と担当医師紐付けの両面から捉えている。
- **ボーナス指摘の有益性**: 正解キー外の追加リスク（Redisセッション設計、アプリケーションレベル暗号化、トークン有効期限）を security スコープ内として正確に識別できている。
- **スコープ境界の遵守**: ペナルティ対象（パフォーマンス、コーディングスタイル等）への不要な踏み込みがなく、セキュリティ設計レビューとしての境界を維持している。
