# 採点結果: v005-cors-bypass-output (doc1)

## スコアサマリ
Run1=11.0(検出10.0+bonus2-penalty0), Run2=11.0(検出9.5+bonus3-penalty0)

## 検出マトリクス
| ID | カテゴリ | 深刻度 | Run1 | Run2 |
|----|---------|--------|------|------|
| P01 | 認証・認可設計 | 重大 | ○ | ○ |
| P02 | 認証・認可設計 | 重大 | ○ | ○ |
| P03 | データ保護 | 中 | ○ | ○ |
| P04 | データ保護 | 軽微 | ○ | ○ |
| P05 | 入力検証・攻撃防御 | 中 | ○ | ○ |
| P06 | 入力検証・攻撃防御 | 中 | ○ | ○ |
| P07 | 脅威モデリング（DoS/ブルートフォース） | 中 | ○ | ○ |
| P08 | インフラ・依存関係・監査 | 軽微 | ○ | △ |
| P09 | 入力検証・攻撃防御 | 重大 | ○ | ○ |
| P10 | インフラ・依存関係・監査 | 軽微 | ○ | ○ |

## カテゴリ別検出率
| Category | Questions | Rate | Detail |
|----------|-----------|------|--------|
| 認証・認可設計 | 2 | 1.00 | Run1: ○○ / Run2: ○○ → (2+2)/4 |
| データ保護 | 2 | 1.00 | Run1: ○○ / Run2: ○○ → (2+2)/4 |
| 入力検証・攻撃防御 | 3 | 1.00 | Run1: ○○○ / Run2: ○○○ → (3+3)/6 |
| 脅威モデリング（DoS/ブルートフォース） | 1 | 1.00 | Run1: ○ / Run2: ○ → (1+1)/2 |
| インフラ・依存関係・監査 | 2 | 0.875 | Run1: ○○ / Run2: △○ → (1+0.5+1+1)/4 |

## ボーナス・ペナルティ詳細
### Run1
- Bonus:
  - M-05 (テナント分離のJWT依存リスク — alg:noneアルゴリズム混乱攻撃): 脅威モデリング(Spoofing/EoP)スコープ内の正解キー未掲載の有益な指摘 +0.5
  - S-04 (ファイルアップロードの型・サイズ制限未定義): B05対応。設計段階での制限未定義を具体的に指摘 +0.5
- Penalty: なし

### Run2
- Bonus:
  - MODERATE-03 (アプリケーションレベル暗号化の未適用): B04対応。診断結果等の高感度フィールドのフィールド暗号化なしを指摘 +0.5
  - MODERATE-01 (ファイルアップロードのセキュリティ制限の未確定): B05対応。設計フェーズでの制限未定義を指摘 +0.5
  - MINOR-01 (テナント間分離の検証設計が不明確): 認証・認可設計スコープ内の正解キー未掲載の有益な指摘 +0.5
- Penalty: なし

## エラー分析（抽象的）

### Missed/Partial by Category
| Category | Problems | ○ | △ | × | Stability | Prompt Gap |
|----------|----------|---|---|---|-----------|------------|
| 認証・認可設計 | 2 | 4 | 0 | 0 | 高安定 | なし |
| データ保護 | 2 | 4 | 0 | 0 | 高安定 | なし |
| 入力検証・攻撃防御 | 3 | 6 | 0 | 0 | 高安定 | なし |
| 脅威モデリング（DoS/ブルートフォース） | 1 | 2 | 0 | 0 | 高安定 | なし |
| インフラ・依存関係・監査 | 2 | 3 | 1 | 0 | 中安定 | セキュリティイベント特有の記録要件（認証失敗・権限変更等）の区別を明示的に要求する指示が不足している可能性。一般的な監査ログとセキュリティ監査ログの区別を指摘させる誘導が弱い。 |

### Improvement Directions
- インフラ・依存関係・監査カテゴリのP08（セキュリティ監査ログ）が1Runで部分検出（△）となった。プロンプトにおいて「一般的な操作ログとセキュリティイベント専用ログの区別」を明示的に評価対象として挙げることで検出安定性が向上する可能性がある。
- 現状、監査ログへの言及があれば△判定となる状況を避けるため、「認証失敗・権限変更・機密データアクセス等のセキュリティイベント記録の有無」を独立した評価軸として明示する方向性が有効と考えられる。

### Strengths to Preserve
- 認証・認可設計カテゴリ: 両Runで完全検出。localStorage保存リスク（XSS経由のトークン窃取）とdoctorロールの横断アクセス問題をいずれも具体的かつ正確に検出できており、トークン管理設計と認可モデルの審査が有効に機能している。
- 入力検証・攻撃防御カテゴリ: CORS/CSRF/バックエンド検証欠如を安定して完全検出。多層防御の観点から各攻撃ベクタを独立して評価するプロンプト構造が有効に働いている。
- 脅威モデリングカテゴリ: 認証エンドポイントへのレート制限未設計をブルートフォース攻撃リスクとして両Runで完全検出。高可用性を理由とするセキュリティ妥協を看過しない評価姿勢が機能している。
- データ保護カテゴリ: VPC内通信の平文化とPIIログ方針の未定義を両Runで完全検出。「VPC内は安全」という誤前提を棄却する評価が安定して機能している。
