# 改善計画: agent_audit_new

## 変更対象ファイル
| # | ファイル | 変更種別 | 変更概要 | 対応フィードバック |
|---|---------|---------|---------|------------------|
| 1 | SKILL.md | 修正 | Phase 2 Step 2a の per-item 承認フローを簡素化し、繰り返しパターンを圧縮 | C-5: 行数超過 (efficiency) |

## 各ファイルの変更詳細

### 1. /home/toyama-ryosuke/ghq/github.com/nangashi/ai-experimental/.claude/skills/agent_audit_new/SKILL.md（修正）
**対応フィードバック**: C-5: SKILL.md が目標行数超過 [efficiency]

**変更内容**:
- **Phase 2 Step 2a（189-207行）**: 冗長な説明を圧縮し、per-item 承認ループの記述を簡潔化
  - 現在: finding の詳細を一つずつ表示する流れが冗長に記述されている（19行）
  - 改善後: テキスト出力フォーマットと承認方針確認を統合し、説明を簡潔化（約12-13行に削減）

- **Phase 2 Step 3（209-231行）**: audit-approved.md の保存フォーマットを簡潔化
  - 現在: フォーマット例が詳細に記載されている（23行）
  - 改善後: 必要最小限の構造のみ記載し、サンプル記述を圧縮（約15行に削減）

- **Phase 3（263-305行）**: 完了サマリの出力例を統合
  - 現在: Phase 2 スキップ時と実行時で別々のサマリ例を記載（43行）
  - 改善後: 条件分岐を明示した単一の出力フォーマットにまとめる（約30行に削減）

**期待される削減**: 約20-25行の削減（305行 → 280-285行、目標250行に対して12-14%超過に改善）

## 新規作成ファイル
（なし）

## 削除推奨ファイル
（なし）

## 実装順序
1. SKILL.md の Phase 2 Step 2a を簡素化（依存関係なし、単独で実施可能）
2. SKILL.md の Phase 2 Step 3 を簡潔化（Step 2a と独立）
3. SKILL.md の Phase 3 を統合（Phase 2 の変更内容を反映）

実装は全て単一ファイル (SKILL.md) への修正であり、各変更は独立しているため順序は柔軟に変更可能。

## 注意事項
- Phase 2 の簡素化により、テキスト出力フォーマットが変更されるが、サブエージェントへの入力フォーマット（Step 4 の Task prompt）には影響しない
- audit-approved.md のフォーマット変更は、apply-improvements.md テンプレートが参照する構造（`### {ID}: {title}` 形式）を維持すること
- Phase 3 の統合により、出力メッセージが若干変更されるが、ユーザー体験の本質（必要情報の提示）は維持すること
- 削減後も目標行数（250行）には届かない可能性が高いが、機能強化の成果（Fast mode対応、エラーハンドリング、検証ステップ）を考慮すると、280-285行は妥当な範囲と判断
