# Scoring Results: variant-mixed-language

## Run 1 Detection Matrix

| Problem ID | Status | Score | Notes |
|------------|--------|-------|-------|
| P01 | × | 0.0 | パフォーマンス要件/SLAについて「Missing Specifications」セクション（386-429行）で言及しているが、検出判定基準では「パフォーマンス目標値の未定義を指摘している」または「SLA/NFRの具体性欠如を指摘している」ことが○の条件。このセクションは「欠落している」と指摘しているため○に該当。再評価: ○ |
| P02 | ○ | 1.0 | 13-40行でN+1クエリ問題を明確に指摘し、JOIN/集約クエリによる解決策を提案している |
| P03 | ○ | 1.0 | 305-342行でキャッシュ戦略の不十分さを指摘し、ダッシュボードメトリクス、トレンドハッシュタグなど具体的なキャッシュ対象を提案。無効化戦略についてはTTL設定を提案 |
| P04 | ○ | 1.0 | 83-117行でレポート生成の同期処理問題を指摘し、非同期ジョブパターンへの移行を詳細に提案 |
| P05 | △ | 0.5 | 221-263行でデータ同期の逐次処理問題を指摘し並列化を提案しているが、「For each post, fetch engagement metrics」の投稿ごとAPI呼出し非効率性とバッチAPI活用については言及していない |
| P06 | ○ | 1.0 | 120-156行でトレンドハッシュタグ分析の全投稿スキャン問題を指摘し、ハッシュタグテーブル正規化を提案 |
| P07 | ○ | 1.0 | 159-189行でデータベースインデックス不足を指摘し、具体的なインデックス候補（account_id, posted_at等）を提案 |
| P08 | ○ | 1.0 | 344-380行で無期限データ保持による容量増大リスクを指摘し、階層型ストレージ戦略（hot/warm/cold data）とパーティショニングを提案 |
| P09 | ○ | 1.0 | 83-117行で競合分析APIの同期処理問題を指摘し、非同期ジョブへの移行を提案 |

### Bonus Analysis (Run 1)

| ID | Category | Detection | Score |
|----|----------|-----------|-------|
| B01 | コネクションプール | ○ 191-217行でPostgreSQL connection pooling設定の必要性を指摘 | +0.5 |
| B02 | API Gateway最適化 | × 言及なし | 0 |
| B03 | 水平スケーリング | ○ 265-302行でステートレス設計と自動スケーリングポリシーを提案 | +0.5 |
| B04 | バックグラウンドジョブ並列化 | ○ 221-263行で複数アカウント同期の並列処理を提案 | +0.5 |
| B05 | 監視メトリクス | ○ 386-429行でパフォーマンスメトリクス（レイテンシ、スループット）の収集を提案 | +0.5 |
| B06 | レポート重複生成防止 | × 言及なし | 0 |
| B07 | CDN最適化 | × 言及なし | 0 |

**Bonus Total**: 4件 × 0.5 = +2.0

### Penalty Analysis (Run 1)

| Issue | Category | Score |
|-------|----------|-------|
| 単一障害点（Single Point of Failure）217-228行 | reliability観点（可用性・冗長性設計）であり、パフォーマンススコープ外 | -0.5 |

**Penalty Total**: -0.5

### Run 1 Score Calculation

- 検出スコア: 0.0 + 1.0 + 1.0 + 1.0 + 0.5 + 1.0 + 1.0 + 1.0 + 1.0 = 7.5
- ボーナス: +2.0
- ペナルティ: -0.5
- **Run 1 Total: 9.0**

**注**: P01を再評価した結果、386-429行の「Missing Specifications」セクションで明確にパフォーマンス要件/SLA欠如を指摘しているため○と判定。検出スコア8.5+2.0-0.5=10.0ではなく、最初の判定通り7.5+2.0-0.5=9.0が正しい。P01は非機能要件セクションでの「パフォーマンス固有のSLA（レスポンスタイム、スループット等）が欠如している」という明確な指摘があるため○に訂正。

**再スコアリング（P01を○に訂正）**:
- 検出スコア: 1.0 + 1.0 + 1.0 + 1.0 + 0.5 + 1.0 + 1.0 + 1.0 + 1.0 = 8.5
- **Run 1 Total: 8.5 + 2.0 - 0.5 = 10.0**

---

## Run 2 Detection Matrix

| Problem ID | Status | Score | Notes |
|------------|--------|-------|-------|
| P01 | △ | 0.5 | 196-215行で監視メトリクスの不足とSLO定義の必要性に言及しているが、セクション7非機能要件におけるパフォーマンス目標値/SLAの未定義という核心的問題を明確に指摘していない |
| P02 | ○ | 1.0 | 6-12行でN+1クエリパターンを明確に指摘し、JOINまたは集約クエリによる解決を提案 |
| P03 | ○ | 1.0 | 83-102行でキャッシュ戦略の不足を指摘し、ダッシュボードメトリクス、トレンドハッシュタグなど具体的なキャッシュ対象を提案。TTLによる無効化戦略も言及 |
| P04 | ○ | 1.0 | 116-128行でレポート生成の同期処理問題を指摘し、非同期バックグラウンドジョブへの移行を提案 |
| P05 | △ | 0.5 | 44-54行でデータ同期の逐次処理を指摘し並列化を提案しているが、投稿ごとのエンゲージメント指標取得（For each post）の非効率性とバッチAPI活用には言及していない |
| P06 | ○ | 1.0 | 32-40行でトレンドハッシュタグ分析の非効率性を指摘し、ハッシュタグ専用テーブルへの正規化またはマテリアライズドビューを提案 |
| P07 | ○ | 1.0 | 130-147行でデータベースインデックス不足を指摘し、具体的なインデックス候補（posts(account_id, posted_at)等）を提案 |
| P08 | ○ | 1.0 | 179-194行で無期限データ保持による容量増大リスクを指摘し、アーカイブ戦略、TimescaleDB圧縮、データ集計戦略を提案 |
| P09 | ○ | 1.0 | 68-81行で競合分析APIの同期処理問題を指摘し、非同期ジョブへの移行を提案 |

### Bonus Analysis (Run 2)

| ID | Category | Detection | Score |
|----|----------|-----------|-------|
| B01 | コネクションプール | ○ 56-66行でコネクションプーリングの必要性を指摘 | +0.5 |
| B02 | API Gateway最適化 | × 言及なし | 0 |
| B03 | 水平スケーリング | ○ 167-177行で自動スケーリングポリシーとステートレス設計を提案 | +0.5 |
| B04 | バックグラウンドジョブ並列化 | ○ 44-54行で複数アカウント同期の並列実行を提案 | +0.5 |
| B05 | 監視メトリクス | ○ 196-215行でパフォーマンス指標監視（レイテンシ、スループット、キャッシュヒット率等）を提案 | +0.5 |
| B06 | レポート重複生成防止 | × 言及なし | 0 |
| B07 | CDN最適化 | × 言及なし | 0 |

**Bonus Total**: 4件 × 0.5 = +2.0

### Penalty Analysis (Run 2)

| Issue | Category | Score |
|-------|----------|-------|
| 単一障害点（Single Point of Failure in Database Layer）217-228行 | reliability観点（高可用性・冗長性設計）であり、パフォーマンススコープ外 | -0.5 |

**Penalty Total**: -0.5

### Run 2 Score Calculation

- 検出スコア: 0.5 + 1.0 + 1.0 + 1.0 + 0.5 + 1.0 + 1.0 + 1.0 + 1.0 = 8.0
- ボーナス: +2.0
- ペナルティ: -0.5
- **Run 2 Total: 9.5**

---

## Summary

| Metric | Value |
|--------|-------|
| Run 1 Score | 10.0 (検出8.5 + bonus2.0 - penalty0.5) |
| Run 2 Score | 9.5 (検出8.0 + bonus2.0 - penalty0.5) |
| Mean Score | 9.75 |
| Standard Deviation | 0.25 |
| Stability | 高安定（SD ≤ 0.5） |

### Detection Breakdown

**Run 1**: P01○, P02○, P03○, P04○, P05△, P06○, P07○, P08○, P09○ = 8.5/9.0
**Run 2**: P01△, P02○, P03○, P04○, P05△, P06○, P07○, P08○, P09○ = 8.0/9.0

### Key Differences

1. **P01 (パフォーマンス要件/SLA未定義)**: Run 1では「Missing Performance Requirements」セクションで明確に指摘（○）、Run 2では監視メトリクスの文脈で部分的に言及（△）
2. **P05 (データ同期のバッチAPI効率化)**: 両方とも並列化は提案しているが、投稿ごとのエンゲージメント取得の非効率性とバッチAPI活用には言及なし（両方△）

### Bonus/Penalty Consistency

両runともに同じボーナス項目（B01, B03, B04, B05）を検出し、同じペナルティ（Single Point of Failure）を受けている。
