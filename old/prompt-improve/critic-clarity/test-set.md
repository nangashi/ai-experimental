# Test Scenarios for critic-clarity Agent

This test set evaluates the agent's ability to identify ambiguous expressions, assess AI behavioral consistency, and verify the executability of evaluation criteria in perspective definitions.

---

## T01: Simple Security Perspective with Clear Criteria

**Difficulty**: Easy
**Category**: Baseline clarity assessment

### Input

以下は観点定義ファイルです:

```markdown
# セキュリティ観点

## 評価スコープ

### 認証・認可
- ユーザー認証が適切に実装されているか（パスワードハッシュ化、セッション管理、MFA対応の有無を確認）
- 権限チェックがすべてのエンドポイントで実施されているか（各APIエンドポイントでのロール検証コードの有無）
- トークン管理が安全か（JWT署名検証、有効期限チェック、リフレッシュトークンの安全な保存）

### データ保護
- 機密データの暗号化が実装されているか（データベース保存時のAES-256暗号化、通信時のTLS 1.2以上）
- ログに個人情報が含まれていないか（ログ出力前のPII検出フィルタの有無）

## スコープ外
- インフラストラクチャのセキュリティ（ネットワーク構成、ファイアウォール設定）
- コンプライアンス要件（GDPR、HIPAA等の法規制適合性）

## 問題バンク

### 重大
- 平文パスワードの保存
- SQL インジェクションの脆弱性（プリペアドステートメント未使用）

### 中
- セッションタイムアウトが24時間以上
- エラーメッセージに内部実装の詳細が露出

### 軽微
- ログに冗長な情報が含まれる（最適化の余地）
```

このファイルを評価してください。

### Quality Rubric

| Criterion ID | Criterion | Full (2) | Partial (1) | Miss (0) | Weight |
|-------------|-----------|----------|-------------|----------|--------|
| T01-C1 | Ambiguity detection completeness | 曖昧な表現がないことを明確に指摘している、または「曖昧な表現はない」と判定している | 一部の明確な表現について言及しているが、全体の評価が不明確 | 曖昧性についての評価がない | 1.0 |
| T01-C2 | Consistency verification | 各評価スコープ項目について「AIが一意に解釈可能か」を検証している | 一部の項目についてのみ一貫性を確認している | 一貫性についての検証がない | 1.0 |
| T01-C3 | Executability assessment | 検出可能性（実行可能性）について各項目を評価している | 一部の項目についてのみ実行可能性を評価している | 実行可能性についての言及がない | 1.0 |
| T01-C4 | Output format compliance | SendMessage形式で「重大な問題」「改善提案」「確認」のセクションを含む | 一部のセクションが欠けている、またはフォーマットが不正確 | 指定されたフォーマットに従っていない | 0.5 |

### Expected Key Behaviors
- 明確な基準（カッコ内の具体例）を「良い点」として認識する
- スコープ外が明確に定義されていることを評価する
- 問題バンクの具体例が深刻度判定の参考になることを認識する

### Anti-patterns
- 明確な基準を「曖昧」と誤判定する
- カッコ内の具体例を無視して評価する
- 出力フォーマットの指示を無視する

---

## T02: Vague Perspective with Subjective Language

**Difficulty**: Medium
**Category**: Ambiguity detection

### Input

以下は観点定義ファイルです:

```markdown
# パフォーマンス観点

## 評価スコープ

### 処理効率
- アルゴリズムの計算量が適切か
- データベースクエリが最適化されているか
- キャッシュが適切に活用されているか

### リソース利用
- メモリ使用量が妥当か
- 不要なライブラリがロードされていないか
- 並列処理が効果的に実装されているか

### レスポンス性
- ユーザー体験を損なわない応答時間か
- 重い処理がバックグラウンド化されているか

## スコープ外
- 詳細なベンチマーク測定
- 特定のハードウェア環境での最適化

## 問題バンク

### 重大
- 応答時間が非常に遅い
- メモリリークが発生している

### 中
- 不要な同期処理がある
- キャッシュが使われていない箇所がある

### 軽微
- 一部のコードに改善の余地がある
```

このファイルを評価してください。

### Quality Rubric

| Criterion ID | Criterion | Full (2) | Partial (1) | Miss (0) | Weight |
|-------------|-----------|----------|-------------|----------|--------|
| T02-C1 | Identification of subjective terms | 「適切」「最適化」「妥当」「効果的」等の主観的表現を3個以上特定している | 主観的表現を1-2個特定している | 主観的表現の指摘がない | 1.0 |
| T02-C2 | Concrete alternative suggestions | 各曖昧な表現に対して具体的な代替案（数値基準、測定方法等）を提案している | 一部の表現についてのみ代替案がある | 代替案の提案がない | 1.0 |
| T02-C3 | Problem bank vagueness detection | 問題バンクの「非常に遅い」「一部のコードに改善の余地」等の曖昧さを指摘している | 問題バンクの曖昧さに触れているが不完全 | 問題バンクの評価がない | 1.0 |
| T02-C4 | AI consistency impact analysis | 曖昧な表現が複数AIの判断にどう影響するかを説明している | 一貫性への影響に触れているが浅い | 一貫性への影響分析がない | 0.5 |

### Expected Key Behaviors
- 「適切」「最適化」「妥当」等の判断基準が不明確な表現を検出する
- 数値基準や測定方法の欠如を指摘する
- 問題バンクの例も曖昧性チェックの対象にする

### Anti-patterns
- 全体的に「曖昧」とだけ述べて具体的な箇所を示さない
- 代替案なしで批判だけする
- 評価スコープのみに注目し、問題バンクを見落とす

---

## T03: Boundary Case Ambiguity

**Difficulty**: Hard
**Category**: Consistency testing (boundary conditions)

### Input

以下は観点定義ファイルです:

```markdown
# コード品質観点

## 評価スコープ

### 可読性
- 変数名・関数名が意味を表しているか
- 複雑なロジックにコメントがあるか
- ネストが深すぎないか（3階層以内を推奨）

### 保守性
- 関数が単一責任を守っているか
- 重複コードが適度に削減されているか（完全なDRY原則ではなく、バランスを考慮）
- テストコードがある場合、カバレッジが十分か

## ボーナス/ペナルティ
- ボーナス: 型安全性が高い設計（TypeScript, 型ヒント等）
- ペナルティ: グローバル変数の過度な使用

## スコープ外
- パフォーマンス最適化
- 特定のコーディング規約（チーム固有のルール）

## 問題バンク

### 重大
- 関数が200行を超える
- テストが全く存在しない

### 中
- ネストが4-5階層
- 一部に重複コードがある

### 軽微
- 変数名が1文字（ただしループカウンタを除く）
```

このファイルを評価してください。

### Quality Rubric

| Criterion ID | Criterion | Full (2) | Partial (1) | Miss (0) | Weight |
|-------------|-----------|----------|-------------|----------|--------|
| T03-C1 | Boundary case identification | 「3階層以内を推奨」と「4-5階層は中程度問題」の間の境界（3.5階層？）の曖昧さを指摘している | ネストの基準について触れているが境界の曖昧さに言及していない | ネストの基準についての評価がない | 1.0 |
| T03-C2 | Subjective balance detection | 「適度に削減」「バランスを考慮」「十分なカバレッジ」等の判断基準が不明確であることを指摘している | これらの表現のうち1-2個について指摘している | 主観的バランス表現の指摘がない | 1.0 |
| T03-C3 | Bonus/Penalty clarity assessment | ボーナス/ペナルティの「高い設計」「過度な使用」の判定基準が曖昧であることを指摘している | ボーナス/ペナルティに触れているが曖昧性の指摘が不十分 | ボーナス/ペナルティの評価がない | 1.0 |
| T03-C4 | Condition-based criteria ambiguity | 「テストコードがある場合」の条件付き基準がAI判断を分岐させる可能性を指摘している | 条件付き基準に触れているが影響分析が浅い | 条件付き基準についての言及がない | 1.0 |
| T03-C5 | Numerical threshold consistency | 「200行」等の数値基準は明確だが、「1文字変数名（ループカウンタ除く）」の例外処理がAI間で一貫するか検証している | 数値基準の明確性または例外処理について触れている | 数値基準についての評価がない | 0.5 |

### Expected Key Behaviors
- 推奨基準と問題基準の間のグレーゾーンを検出する
- 条件付き基準（「〜の場合」）がAI判断を分岐させることを指摘する
- 数値基準は明確だが、例外処理の記述が曖昧になりうることを認識する

### Anti-patterns
- 数値基準があるから「明確」と安易に判断する
- 境界ケース（3階層 vs 4階層の間）の曖昧さを見落とす
- ボーナス/ペナルティセクションを無視する

---

## T04: Multi-layered Scope Definition

**Difficulty**: Medium
**Category**: Executability analysis

### Input

以下は観点定義ファイルです:

```markdown
# アーキテクチャ観点

## 評価スコープ

### モジュール設計
- モジュール間の依存関係が循環していないか
- 各モジュールの責務が明確に分離されているか
- インターフェースが適切に定義されているか

### データフロー
- データの流れが一方向か、または双方向の必然性があるか
- 状態管理が予測可能か
- 副作用が適切に管理されているか

### 拡張性
- 新機能追加時に既存コードの変更が最小限で済む設計か
- プラグイン機構やフックポイントが用意されているか

## スコープ外
- 実装の詳細（具体的なコード品質）
- デプロイ戦略
- データベーススキーマ設計

## 問題バンク

### 重大
- モジュール間に循環依存がある
- グローバル状態が複数箇所から変更される

### 中
- モジュールの責務が曖昧（複数の役割を持つ）
- 拡張ポイントが存在しない

### 軽微
- インターフェースのドキュメントが不足
```

このファイルを評価してください。

### Quality Rubric

| Criterion ID | Criterion | Full (2) | Partial (1) | Miss (0) | Weight |
|-------------|-----------|----------|-------------|----------|--------|
| T04-C1 | Detection method clarity | 「循環依存」は検出方法が明確（依存グラフ分析）だが、「責務の明確性」「適切なインターフェース」は検出方法が不明確であることを指摘している | 一部の項目について検出方法の明確性を評価している | 検出方法についての評価がない | 1.0 |
| T04-C2 | Abstract concept executability | 「予測可能な状態管理」「副作用の適切な管理」等の抽象的概念について、AIが何を具体的に確認すべきか不明確であることを指摘している | 抽象的概念に触れているが実行可能性への影響分析が不十分 | 抽象的概念についての評価がない | 1.0 |
| T04-C3 | Necessity judgment ambiguity | 「双方向の必然性があるか」という判断基準がAI間で一致しない可能性を指摘している | 必然性判断に触れているが曖昧性の指摘が浅い | 必然性判断についての言及がない | 1.0 |
| T04-C4 | Future-oriented criteria difficulty | 「新機能追加時に変更が最小限」という未来予測的基準の評価困難性を指摘している | 拡張性基準に触れているが評価困難性への言及が不十分 | 拡張性基準についての評価がない | 1.0 |
| T04-C5 | Scope boundary clarity | スコープ外の「実装の詳細」と評価スコープの「インターフェース定義」の境界が曖昧であることを指摘している | スコープ境界について触れているが曖昧性の分析が浅い | スコープ境界についての言及がない | 0.5 |

### Expected Key Behaviors
- 抽象的な概念（「予測可能」「適切」等）が検出可能な具体基準に落とし込まれていないことを指摘する
- 未来予測的な基準（拡張性等）の評価困難性を認識する
- スコープとスコープ外の境界が曖昧な箇所を検出する

### Anti-patterns
- 「循環依存」のような明確な基準だけを評価し、抽象的基準を見落とす
- 技術的に正しいかどうかで評価し、「AIが一意に判断できるか」を無視する
- 問題バンクの例が評価スコープの曖昧さを補完できていないことを見落とす

---

## T05: Minimal Scope with Edge Cases

**Difficulty**: Easy
**Category**: Edge case handling

### Input

以下は観点定義ファイルです:

```markdown
# ドキュメント観点

## 評価スコープ

### README
- プロジェクトの目的が記載されているか（1-3文で簡潔に）
- セットアップ手順が記載されているか（手順番号付き、コマンド例を含む）
- ライセンス情報があるか（LICENSE ファイルまたは README 内の記載）

## スコープ外
- API ドキュメントの詳細
- コード内のコメント品質
- 多言語対応（英語以外のドキュメント）

## 問題バンク

### 重大
- README が存在しない
- セットアップ手順が全く記載されていない

### 中
- プロジェクト目的の記載がない
- ライセンス情報がない

### 軽微
- セットアップ手順にコマンド例がない（説明文のみ）
```

このファイルを評価してください。

### Quality Rubric

| Criterion ID | Criterion | Full (2) | Partial (1) | Miss (0) | Weight |
|-------------|-----------|----------|-------------|----------|--------|
| T05-C1 | Concrete criteria recognition | カッコ内の具体的基準（「1-3文」「手順番号付き」「コマンド例を含む」）を明確性の良い例として認識している | 一部の具体基準について言及している | 具体基準の評価がない | 1.0 |
| T05-C2 | Conditional clarity assessment | 「LICENSE ファイルまたは README 内」の OR 条件がAI判断に影響しないことを確認している | OR 条件について触れているが影響分析が不十分 | OR 条件についての言及がない | 1.0 |
| T05-C3 | Scope-out clarity | スコープ外が明確に定義されており、AIが迷わず判断できることを評価している | スコープ外について触れているが評価が浅い | スコープ外についての評価がない | 0.5 |
| T05-C4 | Severity consistency | 問題バンクの深刻度分類が評価スコープと整合していることを確認している | 深刻度について触れているが整合性の確認が不十分 | 深刻度についての言及がない | 0.5 |

### Expected Key Behaviors
- 具体的な数値基準（「1-3文」）や形式指定（「手順番号付き」）を良い点として評価する
- OR 条件（「〜または〜」）が複数の正解パターンを許容していることを認識する
- スコープが狭く明確な場合、それを肯定的に評価する

### Anti-patterns
- 具体基準があっても「改善の余地がある」と過度に批判する
- OR 条件を曖昧性の原因と誤解する
- スコープが狭いことを「不十分」と批判する（狭いことは明確性には有利）

---

## T06: Inconsistent Problem Bank

**Difficulty**: Hard
**Category**: Executability analysis + Consistency testing

### Input

以下は観点定義ファイルです:

```markdown
# テスト観点

## 評価スコープ

### テストカバレッジ
- 主要な機能にテストがあるか
- エッジケースのテストがあるか
- テストが定期的に実行される仕組みがあるか（CI 設定を確認）

### テスト品質
- テストが独立して実行可能か（テスト間の依存がないか）
- モックやスタブが適切に使われているか
- アサーションが具体的か（曖昧な assertTrue ではなく、assertEqual 等）

## スコープ外
- パフォーマンステスト
- E2E テストの詳細なシナリオ設計

## 問題バンク

### 重大
- テストが存在しない
- テストが常に失敗している
- テスト実行に他のテストの成功が必要（依存あり）

### 中
- カバレッジが50%未満
- モックが使われていない箇所がある
- アサーションが曖昧（例: assertTrue のみ）

### 軽微
- 一部のエッジケースにテストがない
- テストの実行時間が長い（5秒以上）
```

このファイルを評価してください。

### Quality Rubric

| Criterion ID | Criterion | Full (2) | Partial (1) | Miss (0) | Weight |
|-------------|-----------|----------|-------------|----------|--------|
| T06-C1 | Scope-bank inconsistency detection | 評価スコープは「主要な機能」「エッジケース」と記載しているが、問題バンクには「カバレッジ50%未満」という数値基準があり、不整合を指摘している | スコープと問題バンクの差異に触れているが不整合の指摘が不十分 | スコープと問題バンクの整合性についての言及がない | 1.0 |
| T06-C2 | Subjective term in scope | 「主要な機能」「適切に使われている」「具体的なアサーション」等の主観的表現を指摘している | 一部の主観的表現について指摘している | 主観的表現の指摘がない | 1.0 |
| T06-C3 | Problem bank concrete criteria recognition | 問題バンクの「カバレッジ50%未満」「5秒以上」等の具体基準を良い例として認識している | 一部の具体基準について言及している | 具体基準の認識がない | 1.0 |
| T06-C4 | Severity boundary ambiguity | 「カバレッジ50%未満は中」だが、「49%と51%」の境界ケースがAI間で一致するか、および「主要な機能のみカバー」との関係が曖昧であることを指摘している | 深刻度境界について触れているが曖昧性の分析が不十分 | 深刻度境界についての言及がない | 1.0 |
| T06-C5 | Example-based clarity | 問題バンクの「例: assertTrue のみ」のような具体例がAI判断を補助することを評価している | 具体例について触れているが効果の評価が浅い | 具体例についての言及がない | 0.5 |
| T06-C6 | Multi-dimensional ambiguity | 「エッジケースのテスト」と「一部のエッジケースにテストがない（軽微）」の関係が曖昧（どの程度のエッジケース欠落が許容されるか）であることを指摘している | エッジケース基準について触れているが曖昧性の分析が不十分 | エッジケース基準についての言及がない | 0.5 |

### Expected Key Behaviors
- 評価スコープと問題バンクの間の不整合（主観的表現 vs 数値基準）を検出する
- 問題バンクに具体的な数値基準がある場合、それを肯定的に評価しつつ、スコープ側の曖昧さを指摘する
- 境界ケース（50%のカバレッジの前後）でのAI判断の一貫性を検証する

### Anti-patterns
- 問題バンクの具体例だけに注目し、評価スコープとの整合性を確認しない
- 数値基準があるから「全体として明確」と判断する
- 深刻度の境界値（50%、5秒等）がエッジケースになることを見落とす

---
