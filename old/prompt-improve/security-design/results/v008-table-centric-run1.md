# Security Design Review: Real Estate Rental Platform

## Score Summary Table

| Criterion | Score (1-5) | Main Reason |
|-----------|-------------|-------------|
| Threat Modeling (STRIDE) | 2 | Multiple critical threat categories lack explicit mitigation strategies, particularly repudiation, tampering, and denial of service |
| Authentication & Authorization Design | 2 | Missing critical security specifications including session management, token refresh mechanisms, and permission models |
| Data Protection | 2 | Encryption at rest not specified, data retention/deletion policies absent, PII protection measures undefined |
| Input Validation Design | 2 | No input validation policy defined, injection prevention strategies missing, file upload security not addressed |
| Infrastructure & Dependencies | 3 | Basic security measures present but lacks secret rotation, dependency scanning, and network security specifications |
| **Overall** | **2.2** | |

## Findings Table (Severity-Priority Order)

| Severity | Issue | Impact | Recommended Countermeasures | Relevant Section |
|----------|-------|--------|----------------------------|------------------|
| Critical | No encryption at rest specification for sensitive data | Sensitive tenant data (SSN, financial information, background check results) stored in PostgreSQL with no encryption specification. Database breach would expose all PII in plaintext. | Implement database encryption at rest (AWS RDS encryption or application-level encryption for sensitive columns). Use envelope encryption for highly sensitive fields (SSN, payment details). | Section 3, 4 (Data Model) |
| Critical | Missing authentication token refresh mechanism | 24-hour JWT expiration with no refresh token strategy creates security vs usability conflict. Long-lived tokens increase breach impact; short-lived tokens force frequent re-authentication. | Implement refresh token rotation pattern: short-lived access tokens (15 min) + long-lived refresh tokens (7 days) with secure storage and rotation on use. | Section 5 (Authentication and Authorization) |
| Critical | No rate limiting on authentication endpoints | Login and registration endpoints lack rate limiting specification, enabling credential stuffing and brute force attacks against user accounts. | Implement progressive rate limiting on auth endpoints: 5 attempts/min per IP, 10/hour per account. Add CAPTCHA after 3 failed attempts. | Section 5 (Authentication Endpoints) |
| Critical | Missing authorization model and permission specifications | Role-based access control mentioned but no permission matrix defined. Unclear how resource ownership validation works (e.g., can a manager access any property or only assigned ones?). | Define explicit permission matrix for each role-resource-operation combination. Document ownership validation rules. Implement attribute-based access control for manager-property relationships. | Section 5 (Authentication and Authorization) |
| Critical | No idempotency guarantees for payment processing | Payment endpoint lacks idempotency key mechanism. Network failures or retries could result in duplicate charges to tenants. | Implement idempotency keys for all payment operations. Store key-result mapping with TTL. Return cached result for duplicate requests within window. | Section 5 (Payment Endpoints) |
| Critical | Missing CSRF protection specification | JWT stored in localStorage with no CSRF token mechanism mentioned. State-changing operations vulnerable to CSRF attacks via malicious sites. | Implement CSRF tokens for all state-changing operations (POST/PUT/DELETE). Use SameSite cookie attribute for session management. Consider moving to httpOnly cookies for token storage. | Section 3 (Data Flow), Section 5 (Authentication) |
| Critical | No audit logging design | No specification for what security events to log (login attempts, permission changes, data access). Impossible to detect or investigate security incidents. | Design comprehensive audit log covering: authentication events, authorization failures, data modifications, payment transactions, application approvals. Define retention policy (minimum 1 year for compliance). Protect logs from tampering. | Throughout |
| Significant | Insufficient data retention and deletion policies | No policies defined for tenant data deletion after lease termination, application rejection, or user account closure. GDPR/CCPA compliance risk. | Define data retention schedules: rejected applications (30 days), terminated leases (7 years for tax), closed accounts (90 days). Implement automated deletion jobs. Provide user data export/deletion API. | Section 4 (Data Model) |
| Significant | Missing input validation policy | No specification for validation rules, sanitization strategies, or injection prevention measures across all user inputs. | Define input validation policy: whitelist validation for all inputs, parameterized queries for SQL, context-aware output encoding, max length limits (email: 255, text fields: 10000 chars). Document validation failures handling. | Section 5 (API Design), Section 6 (Error Handling) |
| Significant | File upload security not addressed | Property images uploaded to S3 but no validation or security controls specified. Risk of malware upload, XXE attacks, or SSRF via image processing. | Implement file upload restrictions: whitelist MIME types (image/jpeg, image/png only), max size 5MB, virus scanning, strip EXIF metadata, generate new filenames (prevent path traversal), separate storage bucket with restrictive permissions. | Section 3 (Components), Section 2 (Key Libraries) |
| Significant | Session management specifications missing | No session timeout, concurrent session limits, or session invalidation strategy defined beyond JWT expiration. | Define session policy: idle timeout (30 min), absolute timeout (24 hours), max concurrent sessions per user (3), immediate invalidation on password change/logout. Implement session tracking in Redis. | Section 3 (Data Flow) |
| Significant | Missing secrets management strategy | AWS Parameter Store mentioned for configuration but no specification for secret rotation, access controls, or encryption key management. | Define secrets management policy: rotate database credentials every 90 days, rotate API keys quarterly, use AWS Secrets Manager for automatic rotation, implement least-privilege IAM policies, encrypt parameters with KMS. | Section 6 (Deployment) |
| Significant | No DoS protection beyond basic rate limiting | API rate limiting defined (100 req/min per IP) but no protection against application-layer DoS (e.g., expensive search queries, background check abuse). | Implement resource quotas: query complexity limits for Elasticsearch, max background checks per tenant (3/month), request timeout (30s), connection limits per user, circuit breakers for external API calls. | Section 7 (Security) |
| Significant | Background check data handling not specified | Integration with Checkr API mentioned but no specification for how sensitive background check results are stored, accessed, or protected. | Define background check data protection: encrypt results at rest, restrict access to owner/manager roles only, implement retention policy (delete after 3 years), audit all access, do not log sensitive findings. | Section 3 (Application Service) |
| Significant | Missing security headers and CSP | No specification for security headers (HSTS, X-Frame-Options, CSP) to protect against clickjacking, XSS, and protocol downgrade attacks. | Implement security headers: Strict-Transport-Security (max-age=31536000), Content-Security-Policy (restrict script sources), X-Content-Type-Options: nosniff, X-Frame-Options: DENY. Configure CloudFront to add headers. | Section 2 (Infrastructure) |
| Moderate | JWT token storage in localStorage | Storing JWT in localStorage makes it accessible to XSS attacks. While not immediately exploitable, increases attack surface. | Consider migrating to httpOnly cookies with SameSite=Strict attribute for token storage. If localStorage required for mobile app compatibility, implement Content Security Policy to mitigate XSS risk. | Section 3 (Data Flow) |
| Moderate | Database connection pool credentials not protected | Connection pooling mentioned but no specification for how database credentials are secured or rotated. | Use IAM database authentication instead of static credentials where possible. If using credentials, store in AWS Secrets Manager with automatic rotation, never in application properties files. | Section 7 (Performance) |
| Moderate | Missing PII classification and handling policy | Multiple PII fields (email, phone, SSN, address) exist in data model but no classification or handling requirements specified. | Define PII classification: High (SSN, financial data), Medium (email, phone, address), Low (preferences). Specify encryption requirements, access controls, and masking rules for each tier. | Section 4 (Data Model) |
| Moderate | Error messages may leak information | Sanitized error messages mentioned but no specification for what information is safe to expose vs what must be suppressed. | Define error handling policy: never expose stack traces, database errors, or internal paths in API responses. Return generic messages for auth failures (don't confirm if user exists). Log full details server-side only. | Section 6 (Error Handling) |
| Moderate | No specification for password complexity requirements | Password hashing specified (bcrypt cost 12) but no password complexity, history, or reset flow security requirements defined. | Define password policy: minimum 12 characters, require mix of character types, prevent common passwords (check against leaked password database), password history (last 5), secure reset flow with time-limited tokens (1 hour expiry). | Section 7 (Security) |
| Moderate | Third-party API failure handling not specified | Integration with Stripe, Checkr, DocuSign but no specification for handling API failures, timeouts, or security of API credentials. | Define third-party integration policy: implement circuit breakers, exponential backoff retry (max 3 attempts), timeout limits (10s), store API keys in Secrets Manager, implement webhook signature verification for callbacks. | Section 2 (Key Libraries) |
| Moderate | Missing database access control specifications | PostgreSQL mentioned but no specification for database user permissions, principle of least privilege, or separation of read/write access. | Implement database access controls: separate users for read vs write operations, application user cannot DROP/ALTER tables, use connection pooling with minimum privilege grants, disable public schema access. | Section 2 (Database) |
| Moderate | No Cross-Origin Resource Sharing (CORS) policy | No CORS policy specified for API endpoints. Either too restrictive (breaking functionality) or too permissive (security risk). | Define CORS policy: whitelist specific frontend domains (no wildcard), allow credentials only for same-site requests, restrict allowed methods to required set (GET, POST, PUT, DELETE), set max-age for preflight caching. | Section 5 (API Design) |
| Moderate | Webhook security not addressed | DocuSign and Stripe likely use webhooks for callbacks but no webhook authentication or validation mentioned. | Implement webhook security: verify signatures using shared secrets, validate payload schemas, implement idempotency for duplicate deliveries, use HTTPS endpoints only, rate limit webhook endpoints. | Section 3 (Core Components) |
| Minor | Elasticsearch access control not specified | Property data indexed in Elasticsearch but no access control or query injection prevention mentioned. | Implement Elasticsearch security: enable authentication, restrict query DSL features (disable script fields), use query templates for user input, separate indexes with access controls, audit search queries. | Section 2 (Database) |
| Minor | Redis security not specified | Redis used for session storage and rate limiting but no authentication or network isolation mentioned. | Secure Redis: enable authentication (requirepass), disable dangerous commands (FLUSHALL, CONFIG), use TLS for connections, network isolation (VPC private subnet), regular snapshots for persistence. | Section 2 (Database) |
| Minor | Automated testing includes security scanning but integration unclear | OWASP ZAP mentioned for vulnerability scanning but no specification for when it runs, what coverage it provides, or how findings are handled. | Integrate OWASP ZAP into CI/CD: run on every PR, fail build on high/critical findings, maintain baseline of accepted risks, schedule regular full scans (weekly), include authenticated scanning for protected endpoints. | Section 6 (Testing) |
| Minor | Monitoring and alerting for security events not defined | CloudWatch, Prometheus, Grafana mentioned for monitoring but no specification for security-related alerts. | Define security monitoring: alert on authentication failure spikes, authorization violations, rate limit triggers, payment anomalies, database query failures. Integrate with incident response runbook. | Section 2 (Infrastructure) |
| Minor | Database backup encryption not specified | Daily full backups and incremental backups mentioned but no specification for backup encryption or secure storage. | Encrypt database backups at rest using AWS KMS, store in separate AWS account or region, test restore procedures quarterly, implement backup retention policy (30 days incremental, 1 year full), restrict access to backup storage. | Section 7 (Availability and Scalability) |
| Minor | No rollback security validation | Automated rollback on health check failures mentioned but no validation that rolled-back version is secure. | Include security checks in rollback decision: verify previous version has no known CVEs, check security scan history, maintain security changelog, require manual approval for rollback beyond previous version. | Section 6 (Deployment) |

## Positive Evaluation Table

| Aspect | Evaluation |
|--------|------------|
| HTTPS/TLS enforcement | All data transmitted over HTTPS/TLS 1.3, properly protecting data in transit |
| Password hashing | Strong password hashing using bcrypt with appropriate cost factor (12) |
| PCI-DSS compliance | Payment card data handled via Stripe, never stored on platform servers, reducing PCI scope |
| External API security | Background checks and payments use HTTPS for third-party API communication (Checkr, Stripe) |
| Basic rate limiting | API rate limiting implemented (100 req/min per IP) provides baseline DoS protection |
| Environment separation | Environment-specific configuration via AWS Parameter Store enables proper secret management across environments |
| Sensitive data logging exclusion | Passwords, tokens, and SSNs explicitly excluded from application logs |
| Role-based access control foundation | RBAC enforced at API Gateway level with role validation on endpoints |
| Automated security testing | OWASP ZAP integrated into testing strategy for vulnerability detection |
| User-facing error sanitization | Error messages sanitized to prevent information disclosure |
