# Problem Generator — v001-baseline

現行の agent_create Phase 2 ロジック（phase2-test-set.md + test-scenario-guide.md）を忠実に移植した単体プロンプト。

---

## あなたのタスク

与えられたエージェント定義を分析し、そのエージェントの性能を評価するためのテストシナリオセットとルーブリックを生成してください。

## 入力

- `{agent_definition_path}`: 評価対象エージェントの定義ファイルパス
- `{knowledge_path}`: 知見ファイルパス（テスト履歴確認用、存在する場合）
- `{test_set_save_path}`: テストシナリオセットの保存先パス
- `{rubric_save_path}`: ルーブリックの保存先パス
- `{agent_name}`: エージェント名

## 手順

### Step 1: エージェント定義の分析

Read で `{agent_definition_path}` を読み込み、以下を特定する:

- **主要タスク**: エージェントは何をするのか
- **想定入力**: エージェントは何を受け取るのか（入力の型と形式）
- **期待出力**: エージェントは何を生成するのか（出力の型と形式）
- **主要な能力カテゴリ**: 3-5個に分類

`{knowledge_path}` が存在する場合は Read で読み込み、テストセット履歴を確認してシナリオの重複を避ける。

### Step 2: テストシナリオの生成

以下のガイドラインに従い、5-8個のテストシナリオを生成する。

#### シナリオ数と分布

| 項目 | 基準 |
|------|------|
| **総数** | 5-8個 |
| **難易度分布** | 易 2個 / 中 3個 / 難 1-3個 |
| **カテゴリ** | 主要能力カテゴリから各カテゴリ最低1個 |

#### 各シナリオの構造

```markdown
### T01: {Scenario Title}

**Difficulty**: Easy / Medium / Hard
**Category**: {テストする能力カテゴリ}

#### Input
{エージェントが受け取る入力コンテンツ。20-100行。}
{実在のプロジェクト/タスクとして自然な内容にすること。}

#### Quality Rubric

| Criterion ID | Criterion | Full (2) | Partial (1) | Miss (0) | Weight |
|-------------|-----------|----------|-------------|----------|--------|
| T01-C1 | {基準名} | {完全達成の条件} | {部分達成の条件} | {未達成の条件} | 1.0 |
| T01-C2 | {基準名} | {完全達成の条件} | {部分達成の条件} | {未達成の条件} | 0.5 |

#### Expected Key Behaviors
- {良い出力に含まれるべき要素}

#### Anti-patterns
- {悪い出力の特徴}
```

#### ルーブリック基準の書き方

- **具体的** であること。「良い分析がある」ではなく「{具体的な問題}について{具体的な対策}を提案している」
- **Full(2) と Partial(1) の境界** を明確にする。核心的ポイントを Full の条件に、周辺的な言及を Partial に
- **Partial(1) の基準** は「関連する内容に触れているが、{核心ポイント}が不足」の形式
- **重み(Weight)** は核心的な基準=1.0、補助的な基準=0.5

基準のカテゴリ例（エージェントのタスクに応じて選択）:
- **Completeness**: 出力に必要な要素がすべて含まれているか
- **Accuracy**: 事実関係や技術的内容が正確か
- **Depth**: 表面的でなく、十分な深さで分析/処理されているか
- **Relevance**: 入力に対して適切な内容を出力しているか
- **Actionability**: 出力が実用的で実行可能な内容か
- **Structure**: 出力が整理されていて読みやすいか

#### 入力コンテンツの作成指針

**分量**: 各シナリオの入力は20-100行。短すぎると評価の解像度が不足し、長すぎるとトークン制限に影響する。

**多様性**:
- 各シナリオで異なるドメイン/トピックを使用する
- 簡単なタスク（明確な入力→明確な期待出力）と難しいタスク（曖昧な入力、複数の正解）を混在させる
- エッジケースや例外的な状況を1-2個含める

**自然さ**:
- 人工的な入力ではなく、実際のユーザーが与えそうな入力を模倣する
- 完璧に整った入力だけでなく、多少の曖昧さや不完全さがある入力も含める

### Step 3: 品質チェック

生成したテストシナリオを保存する前に以下を確認:

- [ ] シナリオが5-8個あるか
- [ ] 難易度の分布が適切か（易2 / 中3 / 難1-3）
- [ ] エージェントの主要能力を網羅しているか
- [ ] 入力コンテンツが自然で現実的か（わざとらしくない）
- [ ] 各シナリオに3-6個のルーブリック基準があるか
- [ ] Full/Partial/Miss の条件が具体的で曖昧さがないか
- [ ] Weight の配分が適切か（核心=1.0、補助=0.5）
- [ ] Expected Key Behaviors と Anti-patterns が記載されているか
- [ ] シナリオ間で入力内容が多様か（同じ種類の入力が連続しない）

### Step 4: 保存

- テストシナリオセットを `{test_set_save_path}` に Write で保存する
- ルーブリック（全シナリオの採点基準をまとめたもの）を `{rubric_save_path}` に Write で保存する
  - ルーブリックファイルにはシナリオごとの基準テーブル、Expected Key Behaviors、Anti-patterns を含める

### Step 5: サマリ返答

以下のフォーマットでサマリのみ返答する:

```
## テストシナリオセット
- エージェント: {agent_name}
- シナリオ数: {N}
- 能力カテゴリ: {カテゴリリスト}

| ID | タイトル | 難易度 | カテゴリ | 基準数 |
|----|---------|--------|---------|--------|
| T01 | {title} | {difficulty} | {category} | {N} |
| T02 | {title} | {difficulty} | {category} | {N} |
...
```
