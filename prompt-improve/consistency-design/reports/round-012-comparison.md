# Round 012 Comparison Report

## 実行条件

- **テスト対象文書**: Real Estate Property Blog Platform 設計書 (Round 012)
- **評価観点**: consistency-design
- **ベースライン**: v012-baseline (C2b-v2: Adversarial視点+既存パターン照合強化)
- **バリアント**: v012-variant-adversarial-checklist (C2b-v3: Adversarial視点+情報欠落チェックリスト統合)
- **実行日**: 2026-02-11

---

## 比較対象

| プロンプト名 | Variation ID | 主要変更点 |
|-------------|-------------|-----------|
| v012-baseline | C2b-v2 | Adversarial視点+既存パターン照合強化（定量的根拠提示、Near-Misses分析） |
| v012-variant-adversarial-checklist | C2b-v3 | Adversarial視点+情報欠落チェックリスト統合（埋め込み問題検出と情報欠落検出の両立） |

---

## 問題別検出マトリクス

| Problem ID | Category | Severity | Baseline Run1 | Baseline Run2 | Variant Run1 | Variant Run2 |
|-----------|----------|----------|--------------|--------------|-------------|-------------|
| **P01** | テーブル名命名規約混在 | 重大 | × | × | × | × |
| **P02** | タイムスタンプカラム名不統一 | 重大 | ○ | ○ | ○ | ○ |
| **P03** | 主キーカラム名不統一 | 重大 | ○ | ○ | ○ | ○ |
| **P04** | APIパスプレフィックス不統一 | 中 | ○ | ○ | ○ | ○ |
| **P05** | APIアクション動詞使用 | 中 | ○ | ○ | ○ | ○ |
| **P06** | レスポンス形式不一致 | 中 | ○ | ○ | ○ | ○ |
| **P07** | HTTP通信ライブラリ選定不一致 | 中 | △ | △ | ○ | ○ |
| **P08** | エラーハンドリング明記不足 | 中 | × | × | ○ | × |
| **P09** | トランザクション管理明記不足 | 軽微 | △ | △ | ○ | ○ |
| **P10** | JWT保存先セキュリティリスク | 軽微 | △ | △ | △ | ○ |

### 検出パターン分析

**Baseline (C2b-v2) の特徴**:
- 完全検出 (○): 5/10問 (P02, P03, P04, P05, P06)
- 部分検出 (△): 3/10問 (P07, P09, P10)
- 未検出 (×): 2/10問 (P01, P08)
- 検出率: 75% (7.5/10)
- 安定性: SD=0.0 (完全に安定)

**Variant (C2b-v3) の特徴**:
- 完全検出 (○): 7-8/10問 (Run1: 7問, Run2: 8問)
- 部分検出 (△): 1/10問 (Run1: P10)
- 未検出 (×): 1-2/10問 (Run1: P01/P08, Run2: P01)
- 検出率: 85-90% (8.5-9.0/10)
- 安定性: SD=0.5 (高安定、閾値以内)

**主要な改善点**:
1. **P07 (HTTP通信ライブラリ選定不一致)**: △→○ (両実行で完全検出達成、+1.0pt)
2. **P08 (エラーハンドリング明記不足)**: ×→○ (Run1のみ検出、+1.0pt)
3. **P09 (トランザクション管理明記不足)**: △→○ (両実行で完全検出達成、+1.0pt)
4. **P10 (JWT保存先セキュリティリスク)**: △→○ (Run2で完全検出達成、Run1は△維持)

**残存課題**:
- **P01 (テーブル名命名規約混在)**: 両プロンプトとも未検出（既存パターンとの単数形/複数形比較が欠落）
- **P08 (エラーハンドリング明記不足)**: Variant Run2で未検出（不安定性の兆候）

---

## ボーナス/ペナルティ詳細

### ボーナス検出

| Bonus ID | Category | Baseline Run1 | Baseline Run2 | Variant Run1 | Variant Run2 |
|---------|----------|--------------|--------------|-------------|-------------|
| **B01** | 外部キー列名不統一 | ○ (+0.5) | ○ (+0.5) | ○ (+0.5) | ○ (+0.5) |
| **B02** | カラム名ケース不統一 | × | × | ○ (+0.5) | ○ (+0.5) |
| **B03** | ディレクトリ構造矛盾 | × | × | × | × |
| **B04** | ログ出力パターン明記不足 | × | × | × | ○ (+0.5) |
| **B05** | エラーコード形式検証欠落 | × | × | × | ○ (+0.5) |
| **B06** | ステータス値命名不統一 | × | × | × | × |

**Baseline ボーナススコア**: 0.5pt (両実行)
**Variant ボーナススコア**: 1.0pt (Run1), 2.0pt (Run2)

**ボーナス検出改善**:
- Run1: +0.5pt (B02追加検出)
- Run2: +1.5pt (B02/B04/B05追加検出)

### ペナルティ

| プロンプト | Run1 | Run2 | ペナルティ内容 |
|----------|------|------|-------------|
| Baseline | 0 | 0 | なし |
| Variant | -0.5 | 0 | Run1: C-8でXSS脆弱性に過度に焦点（セキュリティ評価、一貫性検証ではない） |

---

## スコアサマリ

### 総合スコア

| プロンプト | Run1 | Run2 | Mean | SD | 判定 |
|----------|------|------|------|----|----|
| **Baseline** | 8.0 | 8.0 | **8.0** | 0.0 | 高安定 |
| **Variant** | 9.0 | 10.0 | **9.5** | 0.5 | 高安定 |

### スコア内訳

**Baseline (C2b-v2)**:
- Run1: 7.5 (検出) + 0.5 (bonus) - 0 (penalty) = 8.0
- Run2: 7.5 (検出) + 0.5 (bonus) - 0 (penalty) = 8.0

**Variant (C2b-v3)**:
- Run1: 8.5 (検出) + 1.0 (bonus) - 0.5 (penalty) = 9.0
- Run2: 8.0 (検出) + 2.0 (bonus) - 0 (penalty) = 10.0

### スコア構成分析

| プロンプト | 検出スコア平均 | ボーナス平均 | ペナルティ平均 | 検出主導% | ボーナス主導% |
|----------|--------------|-------------|---------------|----------|-------------|
| **Baseline** | 7.5 | 0.5 | 0 | 93.8% | 6.2% |
| **Variant** | 8.25 | 1.5 | -0.25 | 86.8% | 15.8% |

**傾向分析**:
- Baseline: 検出主導型スコア構成（93.8%）、ボーナス検出最小限
- Variant: 検出+ボーナス混合型、情報欠落チェックリスト統合により探索的な追加指摘が増加
- Variant Run2が最高スコア10.0点達成（検出8.0 + ボーナス2.0）

---

## 推奨判定

### スコア差分析

- **平均スコア差**: 9.5 - 8.0 = **+1.5pt**
- **判定基準** (scoring-rubric.md Section 5):
  - 平均スコア差 > 1.0pt → スコアが高い方を **推奨**

### 安定性分析

| プロンプト | SD | 安定性判定 | 実行間変動要因 |
|----------|----|-----------|--------------|
| Baseline | 0.0 | **高安定** | なし（完全に同一の検出パターン） |
| Variant | 0.5 | **高安定** | ボーナス検出の変動 (1.0→2.0pt)、P08検出の不安定性 (○→×) |

両プロンプトとも高安定性（SD ≤ 0.5）を達成。Variantの実行間変動はボーナス検出の探索性によるもので、埋め込み問題の検出率は安定している。

### 推奨プロンプト

**v012-variant-adversarial-checklist (C2b-v3)** を推奨

**根拠**:
1. 平均スコア差 +1.5pt（判定基準「>1.0pt」を満たす）
2. 安定性は両者とも高安定（SD ≤ 0.5）で同等
3. 情報欠落系問題の検出率向上（P07/P08/P09/P10で改善）
4. ボーナス検出能力の向上（平均1.5pt vs 0.5pt）

---

## 収束判定

### 過去3ラウンドの改善推移

| ラウンド | 推奨プロンプト | Mean Score | 前回からの改善幅 |
|---------|--------------|-----------|----------------|
| Round 010 | C2b (Adversarial視点) | 9.0 | - |
| Round 011 | C2b-v2 (Adversarial+既存パターン照合強化) | 8.0 | -1.0pt |
| Round 012 | C2b-v3 (Adversarial+情報欠落チェックリスト統合) | 9.5 | +1.5pt |

**判定**: **継続推奨**

**理由**:
- Round 011→012の改善幅 +1.5pt（収束基準 < 0.5pt を上回る）
- Round 011は退行（-1.0pt）したが、Round 012で回復+超過
- P01/P08の課題残存、P10の部分検出（Run1）も改善余地あり
- ボーナス検出にまだ伸びしろ（B03/B06未検出）

---

## 考察

### 独立変数ごとの効果分析

#### 1. 情報欠落チェックリストの統合

**独立変数**: Adversarial視点+既存パターン照合 (C2b-v2) → Adversarial視点+情報欠落チェックリスト統合 (C2b-v3)

**効果**:
- **P07 (HTTP通信ライブラリ)**: △→○ (+1.0pt)
  - チェックリスト項目「既存システムの技術選定パターンとの一貫性」が検出を促進
  - OkHttpとRestTemplateの競合を「別ライブラリ新規導入による依存関係複雑化」という核心的問題として検出
- **P08 (エラーハンドリング)**: ×→○ (Run1: +1.0pt, Run2: 未検出)
  - チェックリスト項目「既存システムのエラーハンドリングパターンとの一貫性検証の欠落」が明示的検出を促進
  - Run2での未検出は不安定性の兆候（改善が必要）
- **P09 (トランザクション管理)**: △→○ (+1.0pt)
  - 「既存システムのトランザクション管理パターンとの一貫性が検証できない」という正解キーの核心を捉えた
  - Baseline (C2b-v2) は情報欠落の指摘はあったが一貫性検証の観点が不明確だった

**トレードオフ**:
- P10でRun1が部分検出（△）に留まる（Baselineも△）
- Run1でスコープ外ペナルティ発生（-0.5pt）: XSS脆弱性への過度な焦点

**効果サマリ**:
- 情報欠落系問題（P07/P08/P09）の検出率向上: 平均 1.0pt → 2.83pt (+1.83pt)
- チェックリスト構造が「一貫性検証の欠落」という観点を明示化
- 適用範囲: consistency観点、情報欠落問題全般、既存パターンとの一貫性検証

#### 2. 探索的な追加指摘の増加

**効果**:
- ボーナス検出の大幅改善: 平均 0.5pt → 1.5pt (+1.0pt)
- B02 (カラム名ケース不統一): 両実行で検出
- B04 (ログ出力パターン明記不足): Run2で検出
- B05 (エラーコード形式検証欠落): Run2で検出

**分析**:
- チェックリスト構造が探索的な追加指摘を抑制するという過去の知見 (Round 005) とは異なる結果
- Adversarial視点との組み合わせにより、チェックリスト範囲外の横断的問題も検出可能
- スコア構成が探索主導型にシフト（検出86.8% + bonus15.8%）

#### 3. 安定性への影響

**効果**:
- SD: 0.0 → 0.5（安定性は維持、高安定範囲内）
- 実行間変動要因: ボーナス検出の探索性、P08検出の不安定性

**分析**:
- チェックリスト構造による評価パス標準化効果は一定程度発揮
- P08の不安定性（Run1: ○, Run2: ×）は改善が必要
- ボーナス検出の変動（1.0→2.0pt）は探索的な追加指摘の性質上許容範囲

### 次回への示唆

#### 残存課題

1. **P01 (テーブル名命名規約混在)**: 両プロンプトとも未検出
   - 問題: 既存パターンとの単数形/複数形比較が欠落
   - 改善策: チェックリストに「テーブル名の単数形/複数形パターンの一貫性」項目を追加

2. **P08 (エラーハンドリング明記不足)**: Run2で未検出（不安定性）
   - 問題: チェックリスト項目の強制力が不十分
   - 改善策: 「実装パターンの一貫性検証」を独立したパスとして明示化

3. **P10 (JWT保存先)**: Run1で部分検出（△）
   - 問題: セキュリティリスクへの焦点が一貫性検証を曖昧化
   - 改善策: 「既存システムの保存先パターンとの一貫性検証」を明示的に指示

4. **スコープ外ペナルティ**: Run1でXSS脆弱性への過度な焦点
   - 問題: Adversarial視点が一貫性検証からセキュリティ評価にシフト
   - 改善策: 「一貫性の欠如を悪用するシナリオ」の範囲を明確化

#### 推奨される次回バリアント

**C2b-v4: Adversarial視点+情報欠落チェックリスト統合+スコープ境界明確化**

**主要変更点**:
1. チェックリストに「テーブル名の単数形/複数形パターンの一貫性」項目を追加
2. 「実装パターンの一貫性検証」を独立したパスとして明示化（P08の不安定性解消）
3. Adversarial視点の範囲を明確化（「一貫性の欠如を悪用するシナリオ」＝一貫性検証に限定、セキュリティ評価は補足のみ）
4. P10のような「既存システムの保存先パターンとの一貫性検証」を明示的に指示

**期待効果**:
- P01/P08/P10の完全検出達成により検出率95%以上
- スコープ外ペナルティの完全解消
- 安定性の維持（SD ≤ 0.5）

---

## まとめ

**Round 012 の成果**:
- 情報欠落チェックリストの統合により情報欠落系問題の検出率が大幅向上（+1.83pt）
- ボーナス検出能力の向上（平均+1.0pt）により総合スコア9.5点達成
- 安定性維持（SD=0.5、高安定範囲内）

**残存課題**:
- P01 (テーブル名命名規約混在) の未検出
- P08 (エラーハンドリング明記不足) の不安定性
- P10 (JWT保存先) の部分検出
- スコープ外ペナルティのリスク

**次回推奨**: C2b-v4 (チェックリスト拡張+実装パターン検証明示化+スコープ境界明確化) で検出率95%以上、安定性SD ≤ 0.5を目指す。
