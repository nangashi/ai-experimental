# 採点結果: v010-variant-adversarial

## 実行条件
- **観点**: consistency
- **対象**: design
- **採点日時**: 2026-02-11
- **埋め込み問題数**: 10問
- **実行回数**: 2回

---

## Run 1 検出マトリクス

| 問題ID | カテゴリ | 深刻度 | 判定 | スコア | 根拠 |
|--------|---------|--------|------|--------|------|
| P01 | 命名規約 | 重大 | ○ | 1.0 | C1で単数形/複数形の不整合を明確に指摘。既存システムの複数形パターン（`delivery_routes`, `tracking_events`, `carriers`）と新設計の単数形（`delivery_order`, `tracking_event`, `carrier`）の差異を具体的に記載 |
| P02 | 命名規約 | 中 | ○ | 1.0 | C2でタイムスタンプ列の3つの異なるパターン（`created_at`, `createdAt`, `created_timestamp`）を具体的に列挙し、既存パターンとの不整合を指摘 |
| P03 | 命名規約 | 中 | ○ | 1.0 | C3で`delivery_order_fk`が既存の`_id`サフィックスパターンと異なることを明確に指摘 |
| P04 | API設計 | 中 | ○ | 1.0 | C4でAPIエンドポイントのcamelCase（`/deliveryOrders`）が既存のkebab-case（`/delivery-routes`）と異なることを具体的に指摘 |
| P05 | API設計 | 軽微 | △ | 0.5 | C4で`/updateLocation`について言及があるが、動詞使用と既存の名詞ベースパターンとの不整合という核心には触れていない。RESTful原則の言及はあるが既存パターンとの比較が不十分 |
| P06 | 依存管理 | 中 | ○ | 1.0 | C6でSpring WebFluxが既存のRestTemplateと異なることを明確に指摘し、一貫性のためRestTemplateの使用を推奨 |
| P07 | 実装パターン | 重大 | ○ | 1.0 | C7で個別try-catchが既存のグローバル例外ハンドラ（`@ControllerAdvice`）パターンと異なることを明確に指摘 |
| P08 | 実装パターン | 軽微 | ○ | 1.0 | C8で平文ログが既存の構造化ログJSON形式と異なることを明確に指摘し、JSON形式の使用を推奨 |
| P09 | API設計 | 重大 | ○ | 1.0 | C5でAPIレスポンス形式の不整合（`success`/`result`が既存の`data`/`error`形式と異なる）を明確に指摘 |
| P10 | 実装パターン（情報欠落） | 中 | × | 0.0 | JWTの保存先に関する指摘なし。S2でConfiguration Managementの欠落を指摘しているが、JWTの保存先の既存パターンとの一貫性検証には触れていない |

**検出スコア**: 9.5点

### ボーナス評価

| ID | 内容 | 判定 | スコア | 根拠 |
|----|------|------|--------|------|
| B-1 | トランザクション管理パターンの文書化欠落（S1） | ○ | +0.5 | 既存システムの`@Transactional`パターンが設計書に記載されていないことを指摘。一貫性検証不能な項目として正当な追加指摘 |
| B-2 | 設定ファイル形式の文書化欠落（S2） | ○ | +0.5 | 設定ファイル形式（YAML/JSON）や環境変数命名規則が設計書に欠落していることを指摘。一貫性検証不能な項目として正当な追加指摘 |

**ボーナス合計**: +1.0点

### ペナルティ評価

該当なし

**Run 1 総合スコア**: 9.5 + 1.0 - 0 = **10.5点**

---

## Run 2 検出マトリクス

| 問題ID | カテゴリ | 深刻度 | 判定 | スコア | 根拠 |
|--------|---------|--------|------|--------|------|
| P01 | 命名規約 | 重大 | △ | 0.5 | M1でテーブル名の単数形/複数形について言及はあるが、「Entity section header shows `DeliveryOrder` (singular) but doesn't explicitly state the table name should be plural」という記述で、`tracking_event`, `carrier`が単数形であり既存パターン（複数形）と異なるという核心的ポイントが不明瞭 |
| P02 | 命名規約 | 中 | ○ | 1.0 | S3でタイムスタンプ列の3つの異なるパターンを明確に指摘し、既存パターン（`created_at`, `updated_at`）との不整合を具体的に記載 |
| P03 | 命名規約 | 中 | ○ | 1.0 | M2で`delivery_order_fk`が既存の`_id`サフィックスパターンと異なることを明確に指摘 |
| P04 | API設計 | 中 | ○ | 1.0 | S1でAPIエンドポイントのcamelCase（`/deliveryOrders`）が既存のkebab-case（`/delivery-routes`）と異なることを明確に指摘 |
| P05 | API設計 | 軽微 | △ | 0.5 | S1で`/updateLocation`について言及があるが、動詞使用と既存の名詞ベースパターンとの不整合という核心には触れていない |
| P06 | 依存管理 | 中 | ○ | 1.0 | C1でSpring WebFluxが既存のRestTemplateと異なることを明確に指摘し、一貫性のためRestTemplateの使用を推奨 |
| P07 | 実装パターン | 重大 | ○ | 1.0 | C2で個別try-catchが既存のグローバル例外ハンドラ（`@ControllerAdvice`）パターンと異なることを明確に指摘 |
| P08 | 実装パターン | 軽微 | ○ | 1.0 | C3で平文ログが既存の構造化ログJSON形式と異なることを明確に指摘 |
| P09 | API設計 | 重大 | ○ | 1.0 | S2でAPIレスポンス形式の不整合（`success`/`result`が既存の`data`/`error`形式と異なる）を明確に指摘 |
| P10 | 実装パターン（情報欠落） | 中 | × | 0.0 | JWTの保存先に関する言及はあるが（I5）、既存パターンとの一貫性検証が必要という指摘ではなく、「既存システムの方式が文書化されていない」という記述に留まる |

**検出スコア**: 8.0点

### ボーナス評価

| ID | 内容 | 判定 | スコア | 根拠 |
|----|------|------|--------|------|
| B-3 | クラス命名規約の文書化欠落（I1） | ○ | +0.5 | PascalCaseが暗黙的だが明記されていないことを指摘。一貫性検証のための情報欠落として正当 |
| B-4 | メソッド命名規約の文書化欠落（I2） | ○ | +0.5 | camelCaseが暗黙的だが明記されていないことを指摘。一貫性検証のための情報欠落として正当 |
| B-5 | 設定ファイル形式の文書化欠落（I3） | ○ | +0.5 | YAML/JSON選定基準が欠落していることを指摘。一貫性検証不能な項目として正当 |
| B-6 | 環境変数命名規約の文書化欠落（I4） | ○ | +0.5 | 環境変数の命名規則が欠落していることを指摘。一貫性検証不能な項目として正当 |

**ボーナス合計**: +2.0点

### ペナルティ評価

該当なし

**Run 2 総合スコア**: 8.0 + 2.0 - 0 = **10.0点**

---

## 統計サマリ

| 指標 | 値 |
|------|-----|
| Run 1 | 10.5 (検出9.5 + bonus2 - penalty0) |
| Run 2 | 10.0 (検出8.0 + bonus4 - penalty0) |
| 平均スコア | 10.25 |
| 標準偏差 | 0.25 |
| 安定性 | 高安定 (SD ≤ 0.5) |

---

## 詳細分析

### 検出精度の比較

**Run 1 の特徴**:
- 全10問中9.5問を検出（95%検出率）
- P05（動詞を含むエンドポイント）で部分検出（△）
- P10（JWT保存先）のみ未検出
- ボーナス項目2件を追加指摘（トランザクション管理、設定ファイル形式）
- レポート構成が「Adversarial Mode」を明示し、悪用シナリオを詳述

**Run 2 の特徴**:
- 全10問中8.0問を検出（80%検出率）
- P01（テーブル名）で部分検出（△）、P05で部分検出（△）
- P10（JWT保存先）のみ未検出
- ボーナス項目4件を追加指摘（クラス/メソッド命名、設定ファイル、環境変数）
- 24の問題候補から15の報告項目に絞り込み、優先度分類が詳細

### P01（テーブル名）の判定差異の理由

**Run 1が○、Run 2が△になった理由**:
- Run 1: 「`delivery_order`, `tracking_event`, `carrier` のように単数形と複数形が混在」と明記し、既存パターンとの不整合を直接指摘
- Run 2: 「Entity section header shows `DeliveryOrder` (singular) but doesn't explicitly state the table name should be plural」という表現で、設計書の記述の曖昧性を指摘するに留まり、`tracking_event`, `carrier`が単数形であることへの言及が不明瞭

### P10（JWT保存先）未検出の分析

両実行とも、JWTの保存先に関して以下のように記述があるが、検出判定基準を満たさなかった:

- **Run 1 (S2)**: Configuration Managementの欠落を指摘しているが、JWT保存先の既存パターンとの一貫性検証という点には触れていない
- **Run 2 (I5)**: 「Proposes localStorage but existing system's token storage pattern not documented」と記述があるが、「既存システムのパターンとの一貫性検証が必要」という指摘ではなく、「既存システムの方式が文書化されていない」という記述に留まる

検出判定基準「JWTの保存先（localStorage）が既存システムのパターンと一致するかの検証が必要であることを指摘している、または既存システムのJWT保存パターンに関する情報が設計書に欠落していることを指摘している」の後半（情報欠落の指摘）に近いが、「一貫性検証が必要」という明確な指摘がないため×判定とした。

### ボーナス項目の質

**Run 1のボーナス（2件、+1.0点）**:
- トランザクション管理パターンの文書化欠落: 既存の`@Transactional`パターンが設計書に記載されていないことを指摘。実装パターンの一貫性を検証できないという正当な指摘
- 設定ファイル形式の文書化欠落: 設定ファイル形式や環境変数命名規則の欠落を指摘。依存管理の一貫性を検証できないという正当な指摘

**Run 2のボーナス（4件、+2.0点）**:
- クラス命名規約の文書化欠落: PascalCaseが暗黙的だが明記されていない
- メソッド命名規約の文書化欠落: camelCaseが暗黙的だが明記されていない
- 設定ファイル形式の文書化欠落: Run 1と同様
- 環境変数命名規約の文書化欠落: 環境変数の命名規則が欠落

Run 2のボーナス項目はより細分化されており、命名規約の網羅性が高い。

### 安定性評価

標準偏差0.25（≤ 0.5）で「高安定」判定。両実行とも10点以上の高スコアを維持し、検出パターンの一貫性が確認された。

### Adversarialアプローチの効果

Run 1はレポート冒頭で「Adversarial Mode」を明示し、各問題に「Adversarial Risk」セクションを設けて悪用シナリオを記述:
- 「enables database fragmentation」「forces client code to implement multiple strategies」「enables justification for either pattern」など、技術的負債の蓄積メカニズムを詳述
- 「Impact Analysis」と「Adversarial Risk」を分離し、通常の影響と悪用リスクを明示的に区別

Run 2はPhase 1で「Detection Strategy 5: Exploratory Detection (Adversarial Lens)」を設け、P17-P24として悪用シナリオを列挙:
- 「Exploitation scenario」として具体的な悪用例を記述
- Phase 2では通常の報告形式に統合し、Adversarial分析を「Impact Analysis」セクション内に包含

両方式ともAdversarialアプローチの意図を達成しているが、Run 1の方が「Adversarial Risk」を独立セクションとして明示的に分離しており、リスク分析の可視性が高い。

---

## 結論

v010-variant-adversarial（C2bアプローチ）は、平均10.25点、標準偏差0.25の高い安定性を示した。P10（JWT保存先）の未検出がボトルネックだが、正解キーに含まれる10問中8.5-9.5問を検出し、加えて2-4件の有益な追加指摘を行った。

Adversarialアプローチは両実行とも効果的に機能し、技術的負債の蓄積メカニズムや悪用シナリオの記述により、単なる不整合の列挙を超えた洞察を提供している。
