# Evaluation Rubric: critic-generality

このルーブリックは critic-generality エージェントの出力品質を評価するための採点基準をまとめたものです。

---

## T01: 金融システム向けセキュリティ観点の評価

| Criterion ID | Criterion | Full (2) | Partial (1) | Miss (0) | Weight |
|-------------|-----------|----------|-------------|----------|--------|
| T01-C1 | PCI-DSS依存の検出 | 「PCI-DSS準拠」が特定領域依存として正しく識別され、汎用化提案（「機密データの暗号化方針」等）がある | PCI-DSSへの言及があるが、汎用化提案が不足 | PCI-DSS依存を見逃す | 1.0 |
| T01-C2 | その他スコープ項目の正確な判定 | 項目2-5を「汎用」または「条件付き汎用」として正しく分類 | 一部の項目分類が不正確 | 複数の項目分類が不正確 | 1.0 |
| T01-C3 | 問題バンクの汎用性判定 | 問題バンクの業界依存度（カード情報→機密情報への汎用化可能性）に言及 | 問題バンクに触れるが具体的評価なし | 問題バンクを評価していない | 0.5 |
| T01-C4 | 全体品質判断 | 「特定領域依存1件のため項目の削除または汎用化を提案」の判断が明示 | 全体判断はあるが根拠が曖昧 | 全体品質判断がない | 1.0 |

### Expected Key Behaviors
- PCI-DSSを特定業界（金融）依存として正しく識別
- 「クレジットカード情報」を「機密データ」に汎用化する具体的提案
- アクセス制御・監査ログ・入力検証などの一般的概念は「汎用」と判定
- 特定領域依存が1件のため、観点全体の再設計は不要と判断

### Anti-patterns
- PCI-DSSを一般的な標準と誤認し、汎用と判定する
- すべてのセキュリティ要件を「汎用」と判定し、業界依存を見逃す
- 改善提案が抽象的すぎて実行不可能（「もっと汎用的に」のみ）

---

## T02: 医療システム向けプライバシー観点の評価

| Criterion ID | Criterion | Full (2) | Partial (1) | Miss (0) | Weight |
|-------------|-----------|----------|-------------|----------|--------|
| T02-C1 | 複数の特定領域依存の検出 | HIPAA（医療業界）とGDPR（地域規制）の両方を特定領域依存または条件付き汎用として識別 | いずれか1つのみを識別 | 両方とも見逃す | 1.0 |
| T02-C2 | 汎用項目の識別 | 項目3-5を「汎用」として正しく分類し、その根拠を説明 | 分類は正しいが根拠が不足 | 汎用項目を特定領域依存と誤判定 | 1.0 |
| T02-C3 | 問題バンクの業界依存検出 | PHI・患者・診療記録・処方箋などの医療特化用語を指摘し、汎用化提案を行う | 医療用語の存在は指摘するが汎用化提案なし | 医療用語の偏りを見逃す | 1.0 |
| T02-C4 | 観点全体の再設計判断 | 「特定領域依存が2つ以上あるため観点全体の再設計を提案」の判断 | 再設計の必要性に触れるが根拠が弱い | 全体品質判断がない | 1.0 |
| T02-C5 | 汎用化提案の具体性 | 各依存項目について「削除」または「汎用化」の選択と代替表現を提示 | 提案はあるが具体的な代替表現が不足 | 汎用化提案がない | 1.0 |

### Expected Key Behaviors
- HIPAAとGDPRの両方を業界/地域依存として識別
- 「PHI」「患者」などの医療用語を「個人データ」「ユーザー」等に汎用化する具体的提案
- 「特定領域依存が2つ以上」のため観点全体の再設計を推奨
- 最小権限・保持期間・匿名化などの一般的概念は汎用と判定

### Anti-patterns
- GDPRを「世界的標準」と誤認し汎用と判定する
- 医療用語の偏りを指摘するが、「医療プロジェクトなら問題ない」と容認する
- 観点全体の再設計を提案せず、個別項目の修正のみに留まる

---

## T03: 汎用的なパフォーマンス観点の評価

| Criterion ID | Criterion | Full (2) | Partial (1) | Miss (0) | Weight |
|-------------|-----------|----------|-------------|----------|--------|
| T03-C1 | 全スコープ項目の汎用性確認 | 全5項目を「汎用」として正確に判定し、根拠を提示 | 全て汎用と判定するが根拠が弱い | 一部を誤って特定領域依存と判定 | 1.0 |
| T03-C2 | 問題バンクの汎用性確認 | 全問題例が業界非依存であることを確認し、肯定的評価 | 問題バンクの汎用性に触れるが評価が浅い | 問題バンクを評価していない | 1.0 |
| T03-C3 | 技術スタック依存の不在確認 | 特定のフレームワーク・クラウドプロバイダ・DBMSへの依存がないことを確認 | 技術スタック依存について触れるが確認が不十分 | 技術スタック依存を確認していない | 0.5 |
| T03-C4 | 全体品質の肯定的判断 | 「特定領域依存なし、観点は汎用的で適切」と明確に判断 | 肯定的評価があるが判断が曖昧 | 全体品質判断がない | 1.0 |

### Expected Key Behaviors
- 全項目が業界・規制・技術スタックに依存しないことを確認
- 「レスポンスタイム」「スケーラビリティ」などの普遍的概念であることを指摘
- 問題バンクの例も汎用的（N+1問題、キャッシュ欠如など）と評価
- 改善提案は「なし」または「良い例」として肯定的コメント

### Anti-patterns
- 「データベース」という単語があるため特定技術依存と誤判定
- 「ボトルネック分析」が高度すぎて一部プロジェクトに適用不可と誤判断
- 汎用的な観点に対して無理に改善提案を行う

---

## T04: EC特化の注文処理観点の評価

| Criterion ID | Criterion | Full (2) | Partial (1) | Miss (0) | Weight |
|-------------|-----------|----------|-------------|----------|--------|
| T04-C1 | EC特化項目の検出 | 項目1「カート」、項目4「配送先・郵便番号」をEC業界依存として識別 | いずれか1つのみを識別 | EC特化項目を見逃す | 1.0 |
| T04-C2 | 条件付き汎用項目の判定 | 項目3「決済処理」を条件付き汎用として分類（ECに限らず決済があるシステムに適用可能） | 決済を完全に特定領域依存と誤判定、または完全に汎用と誤判定 | 決済処理を評価していない | 1.0 |
| T04-C3 | 汎用化可能な概念の識別 | 項目2「リソース引当」、項目5「状態遷移」を汎用概念として評価（ECに限らず適用可能） | 一部を汎用と判定するが根拠が弱い | 汎用化可能な概念を見逃す | 1.0 |
| T04-C4 | 問題バンクのEC偏り検出 | 全4問題がEC用語（カート・商品・配送先）を含むことを指摘し、汎用化例を提示 | EC偏りを指摘するが汎用化提案なし | 問題バンクのEC偏りを見逃す | 1.0 |
| T04-C5 | 観点全体の判断 | 「特定領域依存が2つ以上あるため観点全体の再設計を提案」の判断 | 再設計の必要性に触れるが判断が弱い | 全体品質判断がない | 1.0 |

### Expected Key Behaviors
- 「カート」「配送先」などEC特有の用語を識別
- 「在庫引当」→「リソース引当」、「注文ステータス」→「処理ステータス」のように汎用化提案
- 決済処理は「決済があるシステム」という条件付きで汎用性ありと評価
- 問題バンク全体がECドメインに偏っていることを指摘

### Anti-patterns
- 「注文」「決済」などがあらゆるビジネスシステムに存在すると過度に汎用化
- 「配送」を「データ配送」と解釈し、汎用と誤判定
- EC特化を指摘するが、「ECプロジェクトなら有用」として容認

---

## T05: 技術スタック依存の可観測性観点の評価

| Criterion ID | Criterion | Full (2) | Partial (1) | Miss (0) | Weight |
|-------------|-----------|----------|-------------|----------|--------|
| T05-C1 | 複数の技術スタック依存の検出 | CloudWatch、X-Ray、ELK、Prometheusなど、全ての特定技術名を技術スタック依存として識別 | 一部の技術依存を見逃す（3つ以下を識別） | 技術スタック依存をほとんど見逃す | 1.0 |
| T05-C2 | AWS特化の指摘 | CloudWatchとX-RayがAWS特化であることを明示し、クラウドプロバイダ非依存への汎用化を提案 | AWS特化を指摘するが汎用化提案が不足 | AWS特化を見逃す | 1.0 |
| T05-C3 | 汎用概念への変換提案 | 各項目を汎用概念に変換（例: CloudWatch→「メトリクス収集」、X-Ray→「分散トレーシング」） | 汎用概念への言及があるが具体的変換提案が不足 | 汎用化提案がない | 1.0 |
| T05-C4 | 問題バンクの技術依存検出 | 全4問題が特定技術名を含むことを指摘し、技術中立な表現への変更を提案 | 問題バンクの技術依存を指摘するが代替案なし | 問題バンクを評価していない | 1.0 |
| T05-C5 | 観点全体の再設計判断 | 「5項目すべてが特定技術依存のため、観点全体の抜本的再設計を提案」の強い判断 | 再設計の必要性に触れるが判断が弱い | 全体品質判断がない | 1.0 |
| T05-C6 | 唯一の汎用要素の評価 | 項目5「アラート通知」の通知先（Slack/PagerDuty）も特定ツール依存だが、概念自体は汎用と評価 | アラート通知の評価が曖昧 | アラート通知を評価していない | 0.5 |

### Expected Key Behaviors
- CloudWatch、X-Ray、ELK、Prometheusなど全ての特定技術名を識別
- AWSへの過度な依存を指摘
- 「メトリクス収集」「分散トレーシング」「ログ集約」などの技術中立な表現を提案
- 「5項目すべてが特定技術依存」という深刻な状況を指摘し、観点全体の再設計を強く推奨

### Anti-patterns
- 「これらは業界標準ツール」として技術依存を容認
- 特定技術名を残したまま「または同等品」と注釈する程度の弱い提案
- 項目5の通知先（Slack/PagerDuty）の依存を見逃す
- 観点全体の再設計ではなく個別項目の修正のみ提案

---

## T06: 条件付き汎用の認証・認可観点の評価

| Criterion ID | Criterion | Full (2) | Partial (1) | Miss (0) | Weight |
|-------------|-----------|----------|-------------|----------|--------|
| T06-C1 | 条件付き汎用の適切な判定 | 全5項目を「条件付き汎用」として分類し、前提条件（「ユーザー認証があるシステム」）を明記 | 条件付き汎用と分類するが前提条件が不明確 | 完全汎用または特定領域依存と誤判定 | 1.0 |
| T06-C2 | 技術標準の適切な評価 | OAuth 2.0 / OIDCを「広く採用されている技術標準」として汎用性ありと評価 | OAuth/OIDCに触れるが評価が曖昧 | OAuth/OIDCを特定技術依存と誤判定 | 1.0 |
| T06-C3 | 前提条件の具体性 | 「ユーザー認証機能を持つシステム」という前提を明示し、該当しないシステム（組込み、バッチ処理等）を例示 | 前提条件に触れるが具体例が不足 | 前提条件を明記していない | 1.0 |
| T06-C4 | 問題バンクの汎用性評価 | 問題例が認証機能を持つシステムに広く適用可能と評価 | 問題バンクに触れるが評価が浅い | 問題バンクを評価していない | 0.5 |
| T06-C5 | 全体品質判断 | 「条件付き汎用のため、観点名または導入部で前提条件の明記を推奨」の判断 | 全体判断があるが提案が弱い | 全体品質判断がない | 1.0 |

### Expected Key Behaviors
- 全項目が「ユーザー認証機能を持つシステム」という条件下で汎用性があると判定
- OAuth 2.0 / OIDCは広く採用されている標準として汎用性を評価
- 認証機能がないシステム（組込みファームウェア、データ処理パイプライン等）には適用不可と指摘
- 前提条件を観点定義の冒頭に明記することを提案

### Anti-patterns
- 「全システムに認証は必要」として完全汎用と誤判定
- OAuth/OIDCを「特定プロトコル依存」として否定
- 前提条件の明記を提案せず、「そのまま使える」と評価
- MFA等の高度な認証機能を「一部システムには過剰」として特定領域依存と誤判定

---

## T07: 混在型（汎用+依存）のデータ整合性観点の評価

| Criterion ID | Criterion | Full (2) | Partial (1) | Miss (0) | Weight |
|-------------|-----------|----------|-------------|----------|--------|
| T07-C1 | 汎用項目の正確な識別 | 項目1「トランザクション」と項目3「競合解決」を汎用として正しく分類 | 一方のみを汎用と判定 | 汎用項目を見逃すまたは誤判定 | 1.0 |
| T07-C2 | 技術依存項目の検出 | 項目2「外部キー制約」をリレーショナルDB依存（条件付き汎用またはRDB特化）として識別 | 外部キー制約に触れるが依存性の評価が曖昧 | 外部キー制約をDB種別非依存と誤判定 | 1.0 |
| T07-C3 | 規制依存項目の検出 | 項目4「SOX法対応」を特定規制依存として識別し、汎用化（「変更履歴管理」）を提案 | SOX法依存を指摘するが汎用化提案が不足 | SOX法依存を見逃す | 1.0 |
| T07-C4 | 条件付き汎用項目の評価 | 項目5「最終的整合性」を分散システム限定の条件付き汎用として分類 | 分散システム依存に触れるが評価が不明確 | 完全汎用または特定領域依存と誤判定 | 1.0 |
| T07-C5 | 問題バンクの依存度評価 | 問題例の「外部キー制約」「監査」などの偏りを指摘し、技術中立・規制中立な表現を提案 | 問題バンクの偏りを指摘するが代替案なし | 問題バンクを評価していない | 0.5 |
| T07-C6 | 全体品質判断の複雑な推論 | 「汎用2、条件付き汎用2、特定領域依存1の混在。SOX法依存項目の汎用化を推奨、それ以外は前提条件明記で許容可能」の判断 | 全体判断はあるが推奨アクションが不明確 | 全体品質判断がない | 1.0 |

### Expected Key Behaviors
- 項目1「トランザクション（ACID）」と項目3「競合解決戦略」を広く適用可能な汎用概念と判定
- 項目2「外部キー制約」をRDB前提の条件付き汎用と判定（NoSQLには適用不可）
- 項目4「SOX法対応」を特定規制依存として識別し、「変更履歴管理」への汎用化を提案
- 項目5「最終的整合性」を分散システム前提の条件付き汎用と判定
- 全体として、SOX法依存の1項目のみ修正が必要、その他は前提条件明記で許容可能と判断

### Anti-patterns
- 「ACID」「外部キー」などDB用語があるため全体をDB特化と誤判定
- SOX法を「財務システムなら必要」として容認
- 項目5の「分散システム限定」を見逃し、完全汎用と誤判定
- 複雑な混在状況を整理せず、「いくつか問題がある」程度の曖昧な評価
- 外部キー制約を「参照整合性」に汎用化すれば解決と単純化（RDB依存は残る）

---

## T08: 境界線上の判定が必要なテスト観点の評価

| Criterion ID | Criterion | Full (2) | Partial (1) | Miss (0) | Weight |
|-------------|-----------|----------|-------------|----------|--------|
| T08-C1 | 境界線上の技術依存判定 | 項目2「Jest/Mocha」を特定技術依存として識別し、「テストフレームワークの選定」への汎用化を提案 | Jest/Mochaの依存を指摘するが汎用化提案が不足 | Jest/Mochaを「一般的なツール」として汎用と誤判定 | 1.0 |
| T08-C2 | 言語依存の検出 | 項目2が「JavaScriptプロジェクト」限定であることを指摘し、言語非依存への修正を提案 | 言語依存に触れるが評価が曖昧 | 言語依存を見逃す | 1.0 |
| T08-C3 | 汎用概念の適切な判定 | 項目1「カバレッジ」、項目3「E2Eテスト」、項目4「テストデータ管理」を汎用として正しく分類 | 一部の汎用項目を見逃すまたは誤判定 | 汎用項目の判定が不正確 | 1.0 |
| T08-C4 | 条件付き汎用の評価 | 項目5「継続的テスト」をCI/CD基盤がある前提の条件付き汎用として分類 | 条件付き汎用の評価が曖昧 | 完全汎用または特定領域依存と誤判定 | 1.0 |
| T08-C5 | 問題バンクの技術依存検出 | 問題例の「Jest」「CI」などの技術固有用語を指摘し、技術中立な表現を提案 | 技術依存を指摘するが代替案なし | 問題バンクの技術依存を見逃す | 0.5 |
| T08-C6 | 全体品質判断 | 「特定領域依存1件（項目2）の修正を推奨、項目5は前提条件明記で許容可能」の判断 | 全体判断があるが推奨アクションが不明確 | 全体品質判断がない | 1.0 |

### Expected Key Behaviors
- 項目2の「Jest/Mocha」と「JavaScriptプロジェクト」の両方を特定技術・言語依存として識別
- 「テストフレームワークの選定と設定」のような言語・ツール非依存の表現を提案
- カバレッジ・E2Eテスト・テストデータ管理などの普遍的概念を汎用と判定
- 継続的テストは「CI/CD基盤を持つプロジェクト」という前提で条件付き汎用と判定
- 特定領域依存1件のため、項目2の修正のみ推奨

### Anti-patterns
- Jest/Mochaを「業界標準」として汎用と容認
- 「JavaScript以外にも適用できる」として言語依存を否定
- E2Eテストを「WebアプリやモバイルアプリのUI自動化」と狭く解釈し、条件付き汎用と誤判定
- 継続的テストを「全プロジェクトで必須」として完全汎用と誤判定
- 問題バンクの「Jestの設定ファイル」を見逃す

---

## 採点時の注意事項

1. **Full(2) の条件は厳格に適用**: 核心的なポイントがすべて満たされている場合のみ Full を付与
2. **Partial(1) は部分的達成**: 方向性は正しいが深さ・具体性・網羅性のいずれかが不足
3. **Miss(0) は未達成**: 基準に対する言及がない、または明らかに誤った判断
4. **Weight の反映**: 核心的基準（Weight 1.0）を重視、補助的基準（Weight 0.5）は参考程度
5. **Expected Key Behaviors の確認**: 出力がこれらの行動を示しているか確認
6. **Anti-patterns の検出**: これらの失敗パターンが出力に含まれていないか確認
